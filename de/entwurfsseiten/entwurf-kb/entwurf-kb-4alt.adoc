= Entwurf_KB_4alt
:lang: de
include::{includedir}/_header.adoc[]
:position: 5

Im Menü **Einstellungen » Kunden » Kundenklassen** legen Sie Kundenklassen an. Die Verwendungsmöglichkeiten für Ihre Kundendaten werden auf dieser Handbuchseite erklärt. Außerdem erfahren Sie alles wichtige zu Rabatten, wie Sie diese kundenklassen- oder preisbezogen vergeben sowie im Auftrag anpassen können.

toc::[]
[#10]
== Wozu Kundenklassen verwendet werden

Mit Kundenklassen unterteilen Sie Ihren Kundenstamm nach verschiedenen Kriterien. So können Sie eine Kundenklasse festlegen, die an Verbraucher angepasst ist und mit deren Einstellungen die Artikel mit Bruttopreisen im Webshop angezeigt werden. Für Händler legen Sie eine weitere Kundenklasse an mit Anzeige der Nettopreise im Webshop. Weitere Optionen, die individuell festgelegt werden können, sind <</#, **Rabatte** >>, die nur für eine bestimmte Kundenklasse gelten.

[#20]
== B2B-Einstellungen

B2B (Business-to-Business) ist eine Bezeichnung für die Geschäftsbeziehung von Händler zu Händler. In diesem Bereich gelten teilweise andere Gesetze bzw. Regeln als im Geschäft zwischen Händler und Endkunde. plentymarkets verfügt über B2B-Webshop-Funktionalitäten, die eine Anpassung an die Gegebenheiten des Handels unter Händlern ermöglichen. In diesem Kapitel erhalten Sie Informationen zu wichtigen Einstellungen.

[#30]
=== Kundenklassen für Händler

Eine wichtige Basis für eine B2B-Funktionalität ist die Zuordnung von Händlern zu einer eigenen Kundenklasse. Wenn die gewünschten Bedingungen, z.B. Rabatte oder die Anzeige der Preise im Webshop, für verschiedene Händler unterschiedlich sein sollen, legen Sie mehrere Kundenklassen mit jeweils unterschiedlichen Einstellungen an.

[#40]
=== Artikeldarstellung

Wenn Sie möchten, dass Artikel für einen Besucher nur sichtbar sein sollen, wenn sich dieser eingeloggt hat, legen Sie dies im Menü **<<mandant-shop/standard/artikelansichten/grundeinstellungen#, Einstellungen » Mandant (Shop) » Shop wählen » Artikelansichten » Grundeinstellungen  >>​** mit der Option **Artikelanzeige** fest. Beachten Sie dabei, dass Webshopbesucher, die sich nicht im Webshop einloggen, automatisch einer Kundenklasse zugewiesen werden mit allen damit verbundenen Eigenschaften, z.B. welche Preise sie im Webshop sehen. Diese Einstellung nehmen Sie im Menü <<mandant-shop/standard/bestellvorgang/grundeinstellungen#, **Einstellungen » Mandant (Shop) » Shop wählen » Bestellvorgang » Grundeinstellungen**  >> vor.

[#50]
=== Preisdarstellung (Brutto / Netto)

Generell werden Artikelpreise im Webshop inklusive gesetzlicher MwSt. dargestellt. Damit die Preise für einen Firmenkunden, der sich im Webshop einloggt, netto angezeigt werden, muss dieser einer Kundenklasse zugeordnet sein, bei der die Option **Anzeige der Preise im Webshop** auf **Netto** eingestellt ist. Achten Sie daher auf diese Konfiguration für Firmenkunden.

Weiterhin werden in der Kundenklasse die Konditionen für <</#, **Rabatte** >> konfiguriert. Hierbei sind detaillierte Einstellungen und Staffelungen möglich.

[#60]
=== Mehrwertsteueranzeige

Jeder Artikelpreis im Webshop muss mit einem MwSt.-Hinweis versehen werden, damit deutlich wird, ob die MwSt. enthalten ist oder nicht. Dazu müssen im Bereich **CMS » Webdesign** alle Artikelansichten um die Template-Variable **$VATHint** erweitert werden. Diese Template-Variable wird je nach Zustand mit dem Wert **zzgl. ges. MwSt.** oder **inkl. ges. MwSt.** befüllt. Für die Anzeige des MwSt.-Satzes verwenden Sie die Template-Variable **$VAT**.

[cols="a,a"]
|====
|Variable |Erläuterung

|**$VATHint**
|Je nach Konfiguration der Option **Anzeige der Preise im Webshop** in der Kundenklasse wird der Hinweis angepasst. +
**Netto** = der Hinweis **zzgl. ges. MwSt.** wird angezeigt. +
**Brutto** = der Hinweis **inkl. ges. MwSt.** wird angezeigt.

|**$VAT**
|Gibt den Steuersatz aus, z.B. 19%.
|====

__Tab. 1: Variablen für MwSt-Ausgabe__

[#70]
== Kundenklassen anlegen oder bearbeiten

Sie können beliebig viele Kundenklassen einrichten und individuell konfigurieren. Kundenklassen erhalten eine ID, die in der Übersicht vor dem Namen der Kundenklasse angezeigt wird. Die ID bestimmt jedoch keine Reihenfolge, diese wird durch die Option **Position** festgelegt.

[IMPORTANT]
.Standard-Kundenklassen
====
Vor plentymarkets-Version 6.30 waren die Standard-Kundenklassen Standard-Endkunden und Standard-Firmenkunden fest im System hinterlegt. Dies wurde geändert. Neue Systeme oder Systeme, in denen die bisherigen Standard-Kundenklassen vor der Migration nicht genutzt und nicht gespeichert wurden, enthalten ab plentymarkets-Version 6.30 keine vordefinierten Kundenklassen mehr. Wenn dies auf Ihr System zutrifft, können Sie das folgende Kapitel überspringen.
====

[#80]
=== Standard-Kundenklassen

Die bisherigen **Standard-Kundenklassen**, die fest im System integriert waren, wurden migriert und mit einer ID versehen, die diese Klassen bisher nicht hatten. Außerdem wird bei der Migration automatisch ein Wert für die neue Option **Position** vergeben, für diese beiden Klassen ist das Position 1 und 2, sie stehen also in der Auflistung der Kundenklassen ganz oben.

Sind keine weiteren Kundenklassen angelegt, erhalten die beiden Kundenklassen automatisch die IDs [1] und [2]. Sind eigene Kundenklassen vorhanden, wird die ID der Standardklassen automatisch anschließend an die höchste vorhandene ID vergeben. Die bisherigen Standard-Kundenklassen werden jetzt wie eigene Kundenklassen behandelt, d.h. sie sind nicht mehr fest im System hinterlegt, sondern können geändert und gelöscht werden.

image::entwurfsseiten/entwurf-kb/assets/DE-Einstellungen-Kundenklassen-01.png[]

__Bild 1: Tab **Kundenklassen**: Beispielansicht nach der Migration__

[#90]
=== Einstellungen für Kundenklassen

Wird eine neue Kundenklasse angelegt, erscheint diese in der Übersicht im Tab **Kundenklassen**. Nach Änderungen laden Sie das Menü neu, damit die neuen Einstellungen in der Übersicht aktualisiert werden.

[.instruction]
Eine neue Kundenklasse anlegen:

. Öffnen Sie das Menü **Einstellungen » Kunden » Kundenklassen**.
. Klicken Sie auf das Tab **Neue Kundenklasse**. +
→ Das Bearbeitungsfenster für eine neue Kundenklasse wird geöffnet.
. Nehmen Sie die **Einstellungen** gemäß Tabelle 2 vor.
. Klicken Sie auf **Speichern**, um die Einstellungen zu sichern.

[cols="a,a"]
|====
|Einstellung |Erläuterung

|**Mindestbestellmenge**
|Eine Mindestbestellmenge wählen, wenn pro Artikel eine bestimmte Anzahl bestellt werden muss oder um eine Mindestbestellmenge für die Mengenrabatte zu gewährleisten.

|**Bezeichnung**
|Eine Bezeichnung für die neue Kundenklasse eintragen, z.B. **Großhändler** oder **Premiumkunde**.

|**Position**
|Eine Position wird automatisch anschließend an die höchste vorhandene Position vergeben, wenn keine Ziffer eingetragen wird. In erster Linie dient die Position der Sortierung der Kundenklassen im Menü.

|**Zahlungsziel**
|Ein Zahlungsziel in Tagen eintragen, das für diese Kundenklasse gelten soll. Ein beim Kunden im Tab **Kundendaten** hinterlegtes Zahlungsziel hat Priorität vor diesem Zahlungsziel. Ein Zahlungsziel kann weiterhin optional im <<auftraege/einstellungen/dokumente#130., **Dokument** >><<mandant-shop/standard/dokumente/rechnung#, **Rechnung**  >> hinterlegt werden. Dieses Zahlungsziel wird dann in der Rechnung ausgegeben, wenn für einen Kunden und die Kundenklasse kein Zahlungsziel hinterlegt wurden. Dazu die Info zur Gestaltung von Zahlungsbedingungen auf der Handbuchseite <<entwurfsseiten/entwurf-kb/entwurf-kb-4alt#30., **Neuer Kunde** >> beachten.

|**Kunden-ID**
|Kunden-ID eines Kunden eintragen, an den Sammelrechnungen bei <<auftraege/sammelauftraege#, **Sammelaufträgen**  >> geschickt werden sollen. Die betreffenden Sammelaufträge werden kundenklassenspezifisch angelegt und die Rechnung wird an den jeweiligen Kunden gesendet.

|**Rabattart**
|Eine **Rabattart** auswählen. Je nach Rabattart werden mehr oder weniger **Optionen** eingeblendet. Wenn Sie keinen Rabatt wünschen, wählen Sie die Option **Verkaufspreis**.

|**Mengenrabatt**
|Wählen, ob die Mengenrabatte der Verkaufspreise berücksichtigt werden sollen oder nicht. Werden Mengenrabatte nicht berücksichtigt, wird immer ein Verkaufspreis ab Menge 1 gesucht.

|**Erlaubte Zahlungsarten**
|Wählen, welche der im Webshop verfügbaren Zahlungsarten für die jeweilige Kundenklasse erlaubt sein sollen. +
In der Grundeinstellung sind alle verfügbaren Zahlungsarten erlaubt. Werden neue Zahlungsarten integriert, müssen diese hier erlaubt werden, da neue Zahlungsarten nicht automatisch mit in die Erlaubnisliste aufgenommen werden. +
**Wichtig**: Dabei die Einstellungen hinsichtlich der **gesperrten Zahlungsarten** in den Versandprofilen beachten, die für die jeweilige Kundenklasse verwendet wird, bzw. diese Einstellung prüfen, damit es an dieser Stelle nicht zu ungewollten Überschneidungen kommt. Die Zahlungsart, die für eine Kundenklasse erlaubt sein soll, darf in den Versandprofilen nicht gesperrt sein und auch die jeweilige Kundenklasse darf dort nicht gesperrt sein.

|**Zahlungshinweis**
|Ein hier hinterlegter Zahlungshinweis wird auf Einzelrechnungen angezeigt. Das können z.B. besondere Angaben zur Zahlung für eine bestimmte Kundenklasse sein.

|**Anzeige der Preise im Webshop**
|Wählen, ob die Preise im Webshop **Brutto** oder **Netto** angezeigt werden sollen. +
**Wichtig**: Diese Option legt nur die Anzeige der Preise fest, nicht die Berechnung der Preise für die Kundenklasse. Einstellung besonders für die Kundenklasse der Position 1 beachten, da diese Kunden automatisch zugewiesen wird, wenn keine Kundenklasse in den Kundendaten gewählt wurde.
|====

__Tab. 2: Einstellungen für Kundenklassen__

== Sichtbarkeit der Verkaufspreise für Kundenklassen konfigurieren

Die Sichtbarkeit eines Verkaufspreises für Kundenklassen konfigurieren Sie in den Einstellungen des betreffenden Verkaufspreises im Menü **Einstellungen » Artikel » Verkaufspreise**. Sie können dort einzelne Kundenklassen pro Verkaufspreis wählen oder alle Kundenklassen.

image::entwurfsseiten/entwurf-kb/assets/DE-Einstellungen-Kundenklassen-02.png[]

__Bild 2: Sichtbarkeit eines Verkaufspreises beim Artikel konfigurieren__

Verlinken auf das Kapitel für weitere Details.

== Kunden einer Kundenklasse suchen

Auch für die Suche nach bestimmten Kunden können Sie die Zuordnung der Kunden zu Kundenklassen nutzen und diese Kundenklassen mit dem Suchfilter **Klasse** im Menü **Kunden » Kunden bearbeiten** gezielt suchen.

image::entwurfsseiten/entwurf-kb/assets/DE-Einstellungen-Kundenklassen-03.png[]

__Bild 3: Suche nach Kunden einer Kundenklasse__

[.instruction]
Kunden einer Kundenklasse suchen:

. Öffnen Sie das Menü **Kunden » Kunden bearbeiten**.
. Wählen Sie im Dropdown-Menü **Klasse** die Kundenklasse, zu der Sie die passenden Kunden auflisten möchten.
. Klicken Sie auf **Suchen**, um alle Kunden dieser Kundenklasse anzuzeigen.

== Rabatte einrichten

In plentymarkets haben Sie verschiedene Möglichkeiten der Rabattierung, die in diesem Kapitel beschrieben werden.

Erfahren Sie, wo Sie Rabatte einrichten, die automatisch wirksam werden und wo Sie Rabatte manuell vergeben können.

=== Rabatte in Kundenklassen hinterlegen

In einer Kundenklasse legen Sie Rabatte fest, die dann nur für die betreffende Kundenklasse wirksam werden. Darüber hinaus bestehen hier weitere Konfigurationsmöglichkeiten, z.B. die Aktivierung von Mengenrabatten der Verkaufspreise. Beachten Sie dabei, dass sich je nach Konfiguration Rabatte addieren können.

image::entwurfsseiten/entwurf-kb/assets/DE-Einstellungen-Kundenklassen-Rabattsystem-01.png[]

__Bild 1: Rabattoptionen in Kundenklassen__

[cols="a,a"]
|====
|Einstellung |Erläuterung

|<<entwurfsseiten/entwurf-kb/entwurf-kb-4alt##30., **Kundenklassen** >>
|**Einstellungen » Kunden » Kundenklassen**

2+|Rabattarten

|**Kein Rabatt**
|Es wird der Verkaufspreis berechnet.

|**Kundenklassen-Rabatt**
|Der gewünschte Rabatt wird in der Kundenklasse nach Wahl dieser Rabattart in % hinterlegt.

|**Rabatt auf Netto-Warenwert**
|Anhand einer Staffelung werden Rabatte in Abhängigkeit von Netto-Warensummen festgelegt. Diese werden im Warenkorb angezeigt und vom Netto-Verkaufspreis abgezogen.

|**Rabatt auf Zahlungsart**
|Es wird ein Rabatt auf eine oder mehrere Zahlungsarten hinterlegt, der bei Wahl der Zahlungsart im Webshop angerechnet wird.

2+|Weitere Optionen

|**Mengenrabatt**
|Wählen, ob der beim Verkaufspreis mit der Option **Ab Menge** geltende Verkaufspreis berücksichtigt werden soll oder nicht.
|====

__Tab. 1: Rabattoptionen; Einstellungen in Kundenklassen__

=== Verkaufspreise als Rabatte hinterlegen

(Ersetzt die Seite "Artikelbezogene Preisstaffelung") -&gt; abgleichen mit Artikel

Ein mengenbezogener Rabatt wird im Menü **Verkaufspreis** als eigener Preis angelegt. Dort legen Sie mit der Option **Ab Menge** für den betreffenden Verkaufspreis fest, ab welcher Artikelmange der rabattierte Preis gelten soll. Eine Staffelung realisieren Sie durch das Anlegen entsprechender Verkaufspreise mit den gewünschten Mindestmengen. Der rabattierte Verkaufspreis wird aktiviert, wenn Sie in der Kundenklasse die Option **Mengenrabatt** auf **Berücksichtigen** setzen. Ein Kunde erhält den Rabatt, wenn er a) zu der betreffenden Kundenklasse gehört und b) mindestens die beim Verkaufspreis hinterlegte Menge bestellt.

image::entwurfsseiten/entwurf-kb/assets/DE-Einstellungen-Kundenklassen-Rabattsystem-02.png[]

__Bild 2: Rabattoptionen in Verkaufspreisen__

[cols="a,a"]
|====
|Einstellung |Erläuterung

|**Verkaufspreise**
|**Einstellungen » Artikel » Verkaufspreise**

2+|Tab: Einstellungen

|**Ab Menge**
|Festlegen, ab welcher Artikelmange der rabattierte Preis gelten soll.

|**Klasse**
|Die Kundenklassen wählen, für die der Verkaufspreis gelten soll.
|====

__Tab. 2: **Rabattoptionen**; Einstellungen in Verkaufspreisen__

=== Rabatte in Aufträgen manuell vergeben

In der Auftragsübersicht wird eine manuelle Rabattoption pro Artikel links unten neben der Gewichtsangabe angezeigt. Sie können dort per Klick einen Rabatt vergeben oder anpassen. Das gleiche ist in einem Auftrag im Bereich **Artikelpositionen** pro Auftrag und auch global für alle Artikel des betreffenden Auftrags möglich. Für Details beachten Sie die folgende Tabelle.

image::entwurfsseiten/entwurf-kb/assets/DE-Einstellungen-Kundenklassen-Rabattsystem-03.png[]

__Bild 3: Rabatt in der Auftragsübersicht anpassen__

[cols="a,a"]
|====
|Einstellung |Erläuterung

|**Aufträge**
|**Aufträge » Aufträge bearbeiten**

2+|Auftragsübersicht

|**Rabatt**
|Auf den Prozentwert klicken und gewünschten Rabatt wählen.

2+|Auftragseinstellungen, Artikelpositionen, Tab: Bearbeiten

|**Rabatt**
|Auf den Prozentwert klicken, gewünschten Rabatt wählen und speichern.

|**Rabatt für alle Artikel vergeben**
|Auf Option klicken (blaue Schrift), gewünschten Rabatt wählen und speichern. +
Der gewählte Rabatt wird für alle Artikel des Auftrags vergeben.
|====

__Tab. 3: **Rabattoptionen**; Einstellungen in Aufträgen__

== Template-Variablen für Rabatte einfügen

Wählen Sie unter **CMS » Webdesign » Layout** das **Template**, in das Sie eine Liste der rabattierten Preise einfügen möchten. Es stehen die in der Tabelle gezeigten **Template-Variablen** für die Anzeige der Preisliste zur Verfügung. Verwenden Sie die Nummerierung gemäß der in den Kundenklassen hinterlegten Rabatte.

[cols="a,a"]
|====
|Template-Variable |Bedeutung

|**$RebateAvailable**
|Dieser Artikel hat eine Preisstaffelung.

|**$VolumePriceStartingQuantity1**
|Mindestmenge für den ersten Rabattpreis.

|**$VolumePriceStartingQuantity2**
|Mindestmenge für den zweiten Rabattpreis usw.

|...
|...

|**$BasketItemVolumePriceStartingQuantity1**
|Wie vor, Variable für die Mindestmenge des ersten Rabattpreises im Warenkorb.

|**$BasketItemVolumePriceStartingQuantity2**
|Variable für die Mindestmenge des zweiten Rabattpreises im Warenkorb usw.

|...
|...

|**$VolumePrice1**
|Erster Rabattpreis

|**$VolumePrice2**
|Zweiter Rabattpreis usw.

|...
|...

|**$BasketItemVolumePrice1**
|Wie vor, erster Rabattpreis im Warenkorb.

|**$BasketItemVolumePrice2**
|Zweiter Rabattpreis im Warenkorb usw.

|...
|...

|**$Size**
|Einheit 1 bzw. 2
|====

__Tab. 4: Template-Variablen für Preisliste__

=== Code-Beispiel

Mit den Template-Variablen und der IF-Logik setzen Sie die Anzeige einer Rabattstaffelung dynamisch ein. Nachfolgend ein Beispiel-Code.

[source,plenty]
----
include::assets/EX-DE-RebateCode.html[]

----

Fügen Sie den Code im Menü **CMS » Webdesign** an geeigneter Stelle im Bereich **ItemView** in das Template **ItemViewSingleItem** ein und speichern Sie das Template.

