= MFN-Auftragsimport
:lang: de
:keywords: Amazon, Auftrag, Import, Händlerversand, MFN
:position: 30

In diesem best practice werden unterschiedliche Ursachen gelöst, welche dazu führen können, dass eure MFN Aufträge (MFN = merchant fulfillment network, sprich Händlerversand) nicht importiert werden. Dabei gehen wir davon aus, dass in den Amazon Grundeinstellungen der Auftragsimport bereits aktiviert wurde.

== MWS Registrierung

Diese ist dafür zuständig uns als Entwickler für den Zugriff auf eueren Amazon Account zu authorisieren. Durch die Registrierung wird das Zugriffrecht auch in eurem Seller-Central unter **Einstellungen » Benutzerberechtigungen** im Bereich **Amazon MWS Entwicklerberechtigungen** einsehbar. Ist diese Berechtigung nicht vorhanden, können wir weder Daten von Amazon abrufen noch zu Amazon senden (Anfragen werden von Amazon blockiert).

[IMPORTANT]
====
Ihr könnt diesen Fall erkennen, indem ihr in dem oben genannten Bereich im Seller-Central prüft, ob die Berechtigung vorliegt.
Ein weiteres Anzeichen dafür ist die Fehlermeldung: _Error:Access to Reports. (GetReportScheduleList) is denied_ welche ihr dann in fast allen Anfragen bekommt. Zu finden ist diese in den Logs oder im Bereich **System » Märkte » Amazon » Datenaustausch » Berichte**, wenn ihr wie im nächsten Punkt beschrieben die _scheduled reports_ setzt.
====

In unserem <<omni-channel/multi-channel/amazon/amazon-einrichten#100, Handbuch>> ist beschrieben, wie ihr die MWS Registrierung ausführt.

== Auth-Token abgelaufen

Der Auth-Token wird bei der MWS Registrierung generiert. Dieser wird für jeden Abgleich zwischen uns und Amazon verwendet und hängt direkt mit der Berechtigung zusammen. Dieser Token wurde seit geraumer Zeit mit einem Ablaufdatum versehen (letztlich zu eurem Schutz, damit bereits deaktivierte Schnittstellen auch wirklich keinen Zugriff mehr haben nachdem der Token abgelaufen ist).
Im Umkehrschluss bedeutet es, dass dieser Token auch aktualisiert werden muss. Denn wenn dieser abläuft, ist die Entwicklerberechtigung der MWS Registrierung außer Kraft gesetzt und es kann keine Abgleich mehr ausgeführt werden.

[IMPORTANT]
====
Ob der Token abgelaufen ist, erkennt ihr ebenfalls in den Entwicklerberechtigungen in eurem Seller-Central oder an der Fehlermeldung _Access denied_.
====

Den Auth-Token könnt ihr im Bereich **Amazon MWS Entwicklerberechtigungen** im Seller-Central unter **Einstellungen » Benutzerberechtigungen** aktualisieren (Ablaufdatum wird in Zukunft gesetzt, damit ist die Berechtigung wieder aktiv).

== Zugangsdaten nicht korrekt

Selbstverständlich müssen die Zugangsdaten in den Grundeinstellungen passen, damit überhaupt von unserem System aus Kontakt mit eurem Amazon Konto aufgenommen werden kann.

[IMPORTANT]
====
Die Fehlermeldung dazu lautet unter anderem _ERROR: AuthToken is not valid for SellerId and AWSAccountId_ wenn der Händler Token in den Grundeinstellungen nicht korrekt eingetragen ist.
====

Der korrekte Token und eure Verkäufer-ID (auch Merchant-ID genannt) ist über die <<omni-channel/multi-channel/amazon/amazon-einrichten#100, MWS Registrierung>> zu finden (am Ende der Registrierung). Alternativ kann auch die Verkäufer-ID in das Feld Händler-Token eingetragen werden.

[TIP]
====
Nachdem ihr den Händler-Token in den Amazon Grundeinstellungen geändert habt, führt bitte einmal **System » Märkte » Amazon » Datenaustausch » Berichte** Tab **Token-Refresh** aus damit die Änderung direkt greifen kann.
====

== scheduled reports

Passen die oberen Punkte, können die Abgleiche ausgeführt werden. Damit auch Aufträge importiert werden können, muss Amazon Berichte erzeugen, in denen die Aufträge enthalten sind. Diese Berichte rufen wir ab.

[CAUTION]
====
Die Erzeugung der Berichte ist nicht von Amazon voreingestellt. Eine Handlung von euch ist erforderlich.
====

Unter **System » Märkte » Amazon » Datenaustausch » Berichte** könnt ihr die automatische kontinuierliche Erzeugung im Tab **Geplante Berichte** festlegen. Das Ganze nennt sich Scheduler bzw. in diesem Fall, da es sich um Berichte handelt, **scheduled reports**.

. **Amazon-Konto** wählen
. Unter **MFN Orders** den Intervall wählen
. **schedule mfn order report** Ausführen (Zahnrad)

[TIP]
====
Da wir alle 15 Minuten einen Abruf ausführen, mit welchem wir die noch nicht als abgeholt markierten Berichte von Amazon ziehen, legen wir den Intervall mit 15 Minuten nahe.
====

Ob die Ausführung korrekt übernommen wurde, erkennt ihr über die Lupe.

[[scheduledreports]]
.Scheduled Reports einsehen
image::_best-practices/omni-channel/multi-channel/amazon/assets/bp-amazon-mfn-auftragsimport-Lupe.png[Lupe Scheduled Reports]

Als Ergebnis seht ihr die bisher auf eurem Amazon Konto aktivierten Scheduler. Für den MFN Auftragsimport ist der Report Type **Get Orders Data** relevant und sollte auf 15 Minuten eingestellt sein. Diese Einstellung kann auch die Ursache dafür sein, dass Aufträge erst sehr spät importiert werden (hier sind von täglich bis wöchentlich schon alle Intervalle vorgekommen).

== Weitere Fehlermeldung

Bei der Fehlermeldung _The seller does not have an eligible Amazon account to call Amazon MWS._ kann es ebenfalls die Ursache sein, dass keine Berechtigung für den Zugriff von unserem System auf Amazon vorliegt. Dazu einmal wie oben geschrieben die Entwicklerberechtigungen prüfen und wenn nicht vorhanden jene über die MWS Registrierung hinzufügen.
Sollte dies nicht helfen, bitte mit Amazon in Kontakt treten (entweder ist euer Seller-Account kein Power-Anbieter und es kann die Amazon MWS API nicht genutzt werden oder euer Account ist noch nicht komplett freigeschaltet).
