= Kaufabwicklung
:lang: de
// include::{includedir}/_header.adoc[]
:position: 30

*CMS » Webdesign » Bestellvorgang » Kaufabwicklung*

== Kaufabwicklung

Die Kaufabwicklung bildet den zweiten Bereich des Bestellvorgangs. Kunden gelangen in diesen Bereich, indem sie zur Kasse gehen.

[WARNING]
.Gesetzliche Anforderungen
====
Beachte die seit 1.8.2012 geltenden gesetzlichen Anforderungen für den Bestellvorgang. Du findest in den Kapiteln 2 und 3 weitere Hinweise dazu. Hier findest du auch Details zu den Möglichkeiten, die du mit plentymarkets diesbezüglich hast. Beachte dazu auch unseren link:https://www.plentymarkets.eu/blog/Onlinehandel-in-Deutschland-Buttonloesung-und-neue-Informationspflichten/b-882/[Blog-Eintrag].
====

== Kaufabwicklung: Design bearbeiten

Dieser Bereich ist bereits vorkonfiguriert. Du hast jedoch vielfältige Änderungsmöglichkeiten.

Folgende Bereiche kannst du im Menü *Kaufabwicklung* anpassen:

* *Kundenregistrierung* +
Hier kannst du einstellen, welche Felder ein Kunde bei der Registrierung ausfüllen muss, welche Angaben optional sind und ob bestimmte Felder überhaupt angezeigt werden. Dieser Bereich der Kundenregistrierung ist z.B. für B2B-Kunden gedacht und wird mit einer Template-Funktion angezeigt.
* *Login* +
In diesen Bereich gelangt der Kunde direkt, nachd Klick auf *Zur Kasse*. Der Kunde kann wählen, als *Gast* zur Kasse zu gehen, sich zu *registrieren* oder, wenn der Kunde bereits registriert ist, sich anzumelden. Mit den Hinweistextfeldern kannst du dem Kunden Hinweise zu diesen Möglichkeiten mitteilen.
* *Passwort vergessen* +
Klickt der Kunde im Bereich *Login* (Wie möchten Sie zur Kasse gehen?) auf *Passwort vergessen*, gelangt der Kunde in diesen Bereich.
* *Rechnungsanschrift* +
Hierhin gelangt der Kunde, nach dem Klick auf *Weiter* im Login-Bereich. Welche Felder dem Kunden angezeigt werden, hängt davon ab, ob sich der Kunde registrieren möchte oder als Gast den weiteren Bestellvorgang durchläuft. Du wählst, ob die Straße und die Hausnummer in 2 Zeilen, d.h. untereinander, oder in einer Zeile, d.h. nebeneinander, dargestellt werden. Auch die Postleitzahl und den Ort können in einer oder in zwei Zeilen dargestellt werden. Mittels CSS kannst du außerdem festlegen, wo z.B. die Felder *Straße* und *Hausnummer* dargestellt werden. Du kannst z.B. für das englischsprachige Layout definieren, dass das Feld *Hausnummer* vor der Straße angezeigt wird. Trage dazu an der entsprechenden Stelle im CSS statt *float: left;* einfach *float: right;* ein. Trage auch in das Feld selbst *House number + Street* ein, damit der Kunde weiß, welches Feld für welche Informationen gedacht ist. Beachte weiter unten die Hinweise zum Adresszusatz.
* *Lieferanschrift* +
Es werden die gleichen Felder wie im Bereich *Rechnungsanschrift* mit den dort hinterlegten Informationen angezeigt. Die Felder *Packstation*, *PostIdent-Nr.* und *Packstations-Nr.* werden nur angezeigt, wenn du Packstationen als Lieferadresse erlaubst und der Kunde eine Versandart gewählt hat, bei der eine Packstation ein mögliches Lieferziel ist. Beachte weiter unten die Hinweise zum Adresszusatz.
* *DHL-Postfinder* +
In diesem Untermenü konfigurierst du die Einstellungen zum DHL-Postfinder.
* *Zahlungsart* +
Der Kunde hat bereits im Warenkorb die Möglichkeit, eine Zahlungsart zu wählen. Stelle hier ein, dass diese Zahlungsart nicht noch einmal angezeigt werden soll. Passe  dann jedoch die Nummerierung der nachfolgenden Überschriften an. Wenn du hier die Option *Nicht anzeigen* wählst und der Kunde die vorhergehenden Angaben so stark ändert, dass die vom Kunden im Warenkorb gewählte Zahlungsart nicht mehr möglich ist, wird deine Einstellung überschrieben. Der Kunde gelangt dann trotzdem automatisch zu diesem Schritt der Kaufabwicklung. +
Dies gilt auch für die Optionen *Bankinformationen*, *MPay 24 Kreditkarte*, *MPay 24 Kreditkarte und MPay 24 Mobile*, da hier zusätzlich Informationen von Kunden benötigt werden.
* *Versandart* +
Der Kunde hat bereits im Warenkorb die Möglichkeit, eine Versandart zu wählen, so dass du hier einstellen kannst, dass die Versandart nicht noch einmal angezeigt werden soll. Du solltest dann jedoch unbedingt die Nummerierung der nachfolgenden Überschriften anpassen. Wenn du hier die Option *Nicht anzeigen* wählst und der Kunde die Angaben so stark ändert, dass die im Warenkorb gewählte Versandart nicht mehr möglich ist, wird deine Einstellung überschrieben. Der Kunde gelangt dann trotzdem automatisch zu diesem Schritt der Kaufabwicklung.
* *Bestellübersicht* +
Der Kunde sieht hier noch einmal alle Angaben in einer Übersicht und kann durch Klicken auf *Zahlungspflichtig bestellen* die Bestellung abschließen. Der Auftrag wird in deinem System angelegt. Der Bereich *Bestellübersicht* enthält die Option *Position*, anhand derer du die Position in der Übersicht bestimmen kannst.

[IMPORTANT]
.Adresszusatz nicht an alle Versanddienstleister übertragbar
====
Dieses Feld ist für Zusatzangaben zur Adresse vorgesehen, z.B. Appartment 12 a. Ein Kunde kann diese Angabe auch selbst im Bestellvorgang und im Mein-Konto-Bereich hinterlegen. Manche Versanddienstleister verarbeiten dieses Feld allerdings nicht, was bedeutet, dass es nicht auf dem Etikett erscheint. Dies kann dazu führen, dass eine Sendung nicht zugestellt werden kann.

Zu folgenden Versanddienstleistern wird der Adresszusatz derzeit nicht übermittelt:

DHL Freight +
DHL Supply Chain +
Swiss Post

Um deine Kunden diesbezüglich zu informieren, kannst du in den genannten Bereichen z.B. einen Hinweis hinterlegen oder einblenden. Oder du blendest das Feld fallabhängig einfach aus, z.B. mit einem JavaScript.
====

[TIP]
.Tipp: Artikeldetails
====
Im Bereich *Artikel* stellst du individuelle Details zu den Artikeln ein. Dies ist im Zusammenhang mit dem nachfolgenden Hinweis zum Gesetz zum Verbraucherschutz im elektronischen Geschäftsverkehr ein wichtiger Baustein. Du kannst die Artikeldetails nicht nur genau bezeichnen, sondern auch einstellen, welches Detail angezeigt werden soll und welches nicht (<<bild-kaufabwicklung-untermenue-bestelluebersicht>> Pos. 10).
====

[WARNING]
.Schaltfläche: Zahlungspflichtig bestellen
====
Am 01.08.2012 trat eine Gesetzesänderung zur Verbesserung des Verbraucherschutzes vor Kostenfallen im Internet in Kraft. Danach muss der Text der Schaltfläche *Kaufen* so formuliert sein, dass die Kostenpflicht eindeutig erkennbar ist. Der Text *Kaufen* ist demnach nicht mehr ausreichend. Der Gesetzesartikel (siehe link:http://www.gesetze-im-internet.de/bgb/__312j.html[§ 312j BGB, Absatz 3^]) empfiehlt die Formulierung *Zahlungspflichtig bestellen* oder eine Formulierung mit vergleichbar eindeutiger Aussage. Wir haben die Schaltfläche *place_order* entsprechend angepasst. Nimm Änderungen des Textes mit Vorsicht vor und frage ggf. deinen Rechtsberater.
====

== Beispiel: Menüeinstellungen und Ansicht im Webshop

Wir beschreiben nun die Vorgehensweise anhand des Untermenüs *Bestellübersicht*. Du erfährs, wie du die Elemente dieses Bereichs verändern oder ggf. entfernen kannst.

Die Elemente, die nachfolgend beschrieben werden, sind in <<bild-kaufabwicklung-untermenue-bestelluebersicht>> nummeriert. In <<bild-kaufabwicklung-umsetzung-einstellungen-bestelluebersicht>> siehst du diese Elemente in der Bestellübersicht des Webshops. Anhand der Nummerierung findest du das Element, auf das sich die Einstellung in <<bild-kaufabwicklung-untermenue-bestelluebersicht>> bezieht.

[[bild-kaufabwicklung-untermenue-bestelluebersicht]]
.Kaufabwicklung; Optionen im Untermenü *Bestellübersicht*
image::omni-channel/online-shop/webshop-einrichten/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-01.png[]

=== Einstellungen im Untermenü Bestellübersicht

Die in <<bild-kaufabwicklung-untermenue-bestelluebersicht>> verwendeten blauen Positionsnummern findest du auch in <<bild-kaufabwicklung-umsetzung-einstellungen-bestelluebersicht>>. So kannst du die Darstellung im Webshop mit den Angaben im Backend vergleichen. Lediglich die Nummern 9 und 12 findest du nicht in <<bild-kaufabwicklung-umsetzung-einstellungen-bestelluebersicht>>. Nummer 9 ist nicht dargestellt, da es sich bei den Artikeln in <<bild-kaufabwicklung-umsetzung-einstellungen-bestelluebersicht>> nicht um Abo-Artikel handelt. Nummer 12 ist nicht dargestellt, da es sich um eine Ausfuhrlieferung und nicht um eine EU-Lieferung handelt. Nummer 12 würde anstelle von Nummer 13 abgebildet.

.Kaufabwicklung; Optionen im Untermenü *Bestellübersicht*
[cols="1,3,3"]
|====
|Pos. im Bild |Einstellung |Erläuterung

|*1*
|*Titel*
|Der hier eingetragene Titel erscheint als Bereichsüberschrift.

|*2 - 10*
|*Position*
|Mit den Positionen wird die Anordnung der Elemente in der Bestellübersicht verändert. Wenn ein Element in der Bestellübersicht nicht angezeigt werden soll, erfolgt die Einstellung im Bereich *CSS*. Dazu wird *{display:none;}* an der entsprechenden Stelle im Code eingetragen. +
*Tipp*: Den CSS-Code prüfen, wenn Elemente nicht angezeigt werden, und für diese Elemente ggf. den Befehl *{display:none;}* aus dem Code löschen. +
*_Wichtig_*: Dem Abschnitt *Artikel* die Position 9 bzw. eine Position am Ende der Bestellübersicht in unmittelbarer Nähe zur Schaltfläche *Kaufen* geben. Dies wird insbesondere auch in der sogenannten Schaltflächen-Lösung gefordert. +
Wurde das Design des Webshops individuell angepasst, darauf achten, die Positionen entsprechend zu vergeben.

|*10*
|*Artikel*
|Überschrift der *Artikelübersicht* in der Bestellübersicht.

|*10*
|*Artikelüberschriften*
|Überschriften der Bereiche in der *Artikelübersicht*. +
Die Überschriften werden durch Überschreiben der Einträge in den Textfeldern geändert.

|*10*
|*Artikeldetails*
|Die *Artikeldetails*, die in der Bestellübersicht angezeigt werden sollen, mit einem Häkchen markieren. +
In der Grundeinstellung sind *alle* Details markiert. +
Details zu Artikeln können auch über <<artikel/artikel-verwalten#480, Merkmale>> realisiert werden.

|*11*
|*Text nach Summen*
|Der eingetragene Text erscheint unmittelbar unterhalb der Gesamtsumme des Auftrags. +
Auch allgemeine Hinweise z.B. zu Zusatzkosten oder anderen Themen, wie der Schaltflächen-Lösung, können eingetragen werden. Der eingetragene Text wird unabhängig vom Lieferland immer dargestellt.

|*12*
|*Hinweis EU-Lieferungen*
|Der eingetragene Text erscheint unterhalb der Gesamtsumme des Auftrags. Wenn etwas bei *Text nach Summen* eingetragen ist, dann erscheint der Hinweis EU-Lieferungen darunter. +
Auch allgemeine Hinweise zu z.B. Zusatzkosten oder anderen Themen, wie der Schaltflächen-Lösung, können eingetragen werden. Nur wenn es sich bei dem Lieferland um ein EU-Mitgliedsland handelt, wird der eingetragene Text dargestellt. Dies bei der Formulierung beachten.

|*13*
|*Hinweis Ausfuhrlieferungen*
|Der eingetragene Text wird unterhalb der Gesamtsumme des Auftrags angezeigt. Wenn etwas bei *Text nach Summen* eingetragen ist, wird der Hinweis EU-Lieferungen darunter angezeigt. +
Auch allgemeine Hinweise zu z.B. Zusatzkosten oder anderen Themen, wie der Schaltflächen-Lösung, können eingetragen werden. Nur wenn es sich bei dem Lieferland nicht um ein EU-Mitgliedsland handelt, wird der eingetragene Text dargestellt. Dies bei der Formulierung beachten.

|*14*
|*Text vor Schaltfläche*
|Hier z.B. einen Hinweis eintragen, der den Kunden noch einmal auffordert, die angegebenen Daten zu prüfen.

|*15*
|*Text nach*
|Der eingetragene Text wird unterhalb der Bestellübersicht angezeigt.
|====


=== Ansicht der Einstellungen im Webshop

[[bild-kaufabwicklung-umsetzung-einstellungen-bestelluebersicht]]
.Kaufabwicklung; Umsetzung der Einstellungen im Untermenü *Bestellübersicht*
image::omni-channel/online-shop/webshop-einrichten/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-02.png[]

== Kundenregistrierung einrichten (B2B)

Besonders für B2B-Webshops ist eine Registrierung für Händler interessant. Der Händler füllt dazu ein Formular aus. Dadurch wird ein Kundenkonto angelegt. Der Shopbetreiber ordnet dem Kundenkonto später manuell nur noch eine Kundenklasse zu, damit der Händler zu den gewünschten Rabattsätzen einkaufen kann.

Die Registrierung ist im Webshop über eine URL erreichbar, die durch die Template-Variable *$BaseURL4Links-OrderShowQQCustomerRegistration/* ausgegeben wird. Füge diese Template-Variable anstelle einer URL in einen Link ein.

[source,xml]

----
<a href="{% Link_CustomerRegistration() %}" title="Registrierung">HIER REGISTRIEREN</a>

----


Das Design der Registrierungsseite kannst du im Untermenü *Kundenregistrierung* unter *CMS » Webdesign » Bestellvorgang » Kaufabwicklung* konfigurieren.

[TIP]
.Tipp: Template-Funktion nutzen
====
Alternativ kannst du auch die Template-Funktion *{% Link_CustomerRegistration() %}* in das Template einfügen und die Kundenregistrierung wird darüber aufgerufen. Du findest diese Funktionen über das Symbol *Template-Variablen und -Funktionen* (<<bild-kaufabwicklung-template-variablen-funktionen>> , grüner Pfeil) unter *Global* und dort im Ordner *PageDesignFunctions*.
====

.Kaufabwicklung; Untermenü *Kundenregistrierung*
image::omni-channel/online-shop/webshop-einrichten/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-03.png[]

Du kannst in diesem Untermenü *Pflichtfelder* festlegen, die dann ausgefüllt werden müssen.

[WARNING]
.Pflichtfeld Telefonnummer
====
Die Angabe der Telefonnummer ist z.B. bei Rückfragen oder Rückmeldungen wichtig. Bei fehlender Telefonnummer kommt es bei Auslandsbestellungen bzw. Sendungen zu einer Fehlermeldung bei der Datenübergabe an DHL Intraship, da dort bei Auslandsversand die Telefonnummer eine Pflichtangabe ist.
====

== Bilder-Galerie und Template-Variablen und -Funktionen

[[bild-kaufabwicklung-template-variablen-funktionen]]
.Kaufabwicklung; Template-Variablen und -Funktionen
image::omni-channel/online-shop/webshop-einrichten/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-04.png[]

=== Bilder-Galerie

Durch Klick auf <<omni-channel/online-shop/cms#bilder-galerie, Bilder-Galerie>> (<<bild-kaufabwicklung-template-variablen-funktionen>> , blauer Pfeil) öffnest du die Bilder-Galerie. Hier wählst du die Bilder, die du in dem Bereich hinterlegen möchtest.

Weitere Informationen zum Einbinden von Bildern aus der Bilder-Galerie findest du in der Tabelle auf der Handbuchseite <<omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/warenkorb#, Warenkorb>>.

=== Template-Variablen und -Funktionen

Eine Übersicht aller in diesem Bereich verwendbaren Template-Variablen und -Funktionen öffnest du, indem du auf das Symbol klickst (<<bild-kaufabwicklung-template-variablen-funktionen>> , grüner Pfeil). Wenn du eine Template-Variable oder -Funktion in einen Hinweistext oder in das CSS einfügst, wird der Inhalt während der Kaufabwicklung angezeigt.

[IMPORTANT]
.Beispiel: Darstellung von Preisen
====
Template-Variablen wie *$ItemAmountNetDot* dienen der Darstellung von Zahlenwerten (Preisen). Der letzte Teil der Variablen, hier Dot, gibt das Trennzeichen, z.B. vor einem Centbetrag, an. Du kannst somit diese Template-Variablen nutzen, um für die jeweilige Sprache die Anzeige der Preise, Versandkosten etc. anzupassen. So kannst du für das deutsche Design die Kommaseparierung und für das englische Design die Punktseparierung bei Geldbeträgen umsetzen.
====

[WARNING]
.Dot-Variablen
====
Wenn du diese Template-Variablen an anderer Stelle zur Übertragung von Daten verwenden möchtest, musst du die Dot-Variablen verwenden, die als einzige Variablen für eine Datenübertragung geeignet sind.
====

Die Template-Variablen und -Funktionen findest du unter *CMS » Webdesign* nach Klick auf das Icon *Template-Variablen und -Funktionen*. Im Ordner *Basket* befinden sich Unterordner der entsprechenden Bereiche der Kaufabwicklung mit den verfügbaren Funktionen und Variablen.

== Design-Beispiel

Nachfolgend findest du ein Design-Beispiel für die Kaufabwicklung deines Webshops sowie den entsprechenden CSS-Code.

=== Kaufabwicklung als Tabs

Mit dem folgenden CSS-Code werden die Schritte der Kaufabwicklung, die im Standard-Layout als Untermenüs angezeigt werden, in Tabs dargestellt (<<bild-kaufabwicklung-darstellung-tabs>>).

[[bild-kaufabwicklung-darstellung-tabs]]
.Kaufabwicklung; Darstellung in Tabs
image::omni-channel/online-shop/webshop-einrichten/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-05.png[]

Die Breite der Tabs ist im Standard-Layout nicht hinterlegt, sondern wird durch den folgenden CSS-Code festgelegt. Aufgrund dieser Festlegung ist nur eine bestimmte Zeichenlänge für die Titel der Tabs möglich. Passe  die Titeltexte ggf. entsprechend an. Die Bezeichnungen bzw. Texte der Tabs sind in den Untermenüs unter *CMS » Webdesign » Bestellvorgang » Kaufabwicklung* hinterlegt und können dort geändert werden. Passe  dazu die Textzeile *Titel* wie gewünscht an (siehe auch <<bild-kaufabwicklung-darstellung-tabs>>).

[.instruction]
CSS-Code für Tab-Darstellung einfügen:

. Kopiere den folgenden Code
. Öffne das Menü *CMS » Webdesign*.
. Öffne das Untermenü *Layout » CSS » CSSOrder*.
. Füge den Code anschließend an den bestehenden Code ein.
. *Speichere* die Einstellungen.

*Code für die Darstellung der Kaufabwicklung als Tabs:*

[source,plenty]
----
/* TAB CHECKOUT */

/* parent container */
#PlentyOrderCheckoutAccordion {
position: relative;
padding-top: 1px;
}
/* anchors */
#PlentyOrderCheckoutAccordion > a {
position: absolute;
top: 0;
left: 0;
}
/* tabs */
.AccordionTitle {
position: absolute;
top: 0;
white-space: nowrap;
overflow: hidden;
background: #ffffff !important;
border: 1px solid #eeeeee;
border-bottom: 2px solid #CCCCCC;
font-size: 12px;
line-height: 26px;
padding: 5px 10px;
/*text-align: center;*/
}
/* tabs hover */
.AccordionTitle:hover {
background: #f9f9f9 !important;
}
/* individual tabs */
#PlentyOrderWebLoginTitle { left: 0; width: 138px; }
#PlentyOrderWebInvoiceDetailsTitle { left: 140px; width: 158px; }
#PlentyOrderWebShippingDetailsTitle { left: 290px; width: 118px; }
#PlentyOrderWebPaymentMethodTitle { left: 420px; width: 108px; }
#PlentyOrderWebShippingMethodTitle { left: 530px; width: 98px; }
#PlentyOrderWebOrderOverviewTitle { left: 630px; width: 78px; }
/* current tab */
.CurrentAccordionTitle {
background: #cccccc !important;
border: 1px solid #CCCCCC !important;
border-bottom: 2px solid #CCCCCC !important;
}
/* tabs hover */
.CurrentAccordionTitle:hover {
background: #CCCCCC !important;
}
/* content */
#PlentyOrderCheckoutAccordion > .AccordionPane {
margin-top: 43px;
} <font face="Times"<span style="white-space: normal;"
</span></font>
----
