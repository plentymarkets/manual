= Variantenanlage
:lang: de
include::{includedir}/_header.adoc[]
:keywords: ElasticSync, Import, Artikel, Artikelanlage, Best Practice, automatisiert, Variantenanlage
:position: 120
:url: daten/daten-importieren/elasticsync-best-practices/best-practices-elasticsync-variantenanlage
:id: K1IPG4S

In diesem Beitrag bieten wir dir ein Best Practice für das Erstellen von Artikeln und Varianten via ElasticSync.

NOTE: Für dieses Best Practice solltest du mit der generellen Funktionsweise von ElasticSync vertraut sein. Allgemeine Infos dazu findest du auf der Handbuchseite <<daten/daten-importieren/ElasticSync#, Daten mit ElasticSync importieren>>.

[#voraussetzungen]
== Voraussetzungen

Im System müssen folgende Daten vorhanden sein, um wie hier beschrieben Artikel und Varianten über ElasticSync zu importieren:

* Attribute
* Attributwerte
* Kategorien
* Verkaufspreise

[#infos]
== Infos

Unter *Einrichtung » Einstellungen » ElasticSync*, oder auch direkt im Sync findest du die Schaltfläche *Cache löschen*.

Mit dieser Schaltfläche kannst du den ElasticSync-Cache zurücksetzen, damit du eine Datei ohne vorherige Änderung erneut importieren kannst.

Eine weitere hilfreiche Schaltfläche ist *Testlauf*.

.Testlauf

image::daten/daten-importieren/assets/testlauf_button.png[]

Damit werden die ersten 10 Zeilen der Datei ohne Cache importiert. So kannst du prüfen, ob alle Werte korrekt zugeordnet wurden, bevor du den Sync mit allen Zeilen startest.

Gültige Werte für Felder in der Zuordnung findest du in der Beschreibung im Handbuch.

Unter *Daten » Log* können Fehlermeldungen zum Sync eingesehen werden.

[#aufbau_des_syncs]
== Beispiel-Daten für die Variantenanlage

Hier könnt ihr euch die Beispieldatei als CSV, so wie den Sync als json-Datei herunterladen.

=== Beispieldatei
Folgende link:https://cdn02.plentymarkets.com/pmsbpnokwu6a/frontend/ElasticSync_BestPractice/BestPractice.csv[Beispieldatei^] wurde für den Sync genutzt.

=== Beispielsync
Den kompletten Sync kannst du als link:https://cdn02.plentymarkets.com/pmsbpnokwu6a/frontend/ElasticSync_BestPractice/Best_Practice.json.zip[json-Datei^] (verpackt als zip-Datei) hier herunterladen.

=== Allgemein

Die Daten, die *global* am Artikel gepflegt werden, wie z.B. *der Name, die Beschreibung etc.* sollten in jeder Zeile, die Varianten eines Artikels beinhalten, hinterlegt werden. Alternativ kannst du auch eine separate Zuordnung mit entsprechendem Filter anlegen, in der die Beschreibung nur in der Zeile der Hauptvariante hinterlegt werden muss.

Daten, die *variantenbezogen* sind, müssen in die entsprechenden Zeilen der Varianten eingetragen werden.

Wichtig bei der Anlage der Varianten ist, dass der Aufbau der Attribute und Werte so in der Datei hinterlegt ist, wie es in der Zuordnung eingestellt ist.

=== Variantennummern

In unserem Beispiel legen wir eine Hauptvariante mit 4 Varianten an. Als Zuordnung für die Varianten nutzen wir die Hauptvariantennummer.

Da der Sync die Daten zeilenweise importiert, steht die Hauptvariante ganz oben in der Datei.

Dort hinterlegen wir manuell die Variantennummer im gleichnamigen Feld. Das Feld *Hauptvariantennummer* bleibt leer.

Diese Variantennummer wird nun wiederum bei den Varianten in das Feld *Hauptvariantennummer* geschrieben, damit sie eine Zuordnung zur Hauptvariante haben und nicht als Einzelartikel angelegt werden.

Die Variantennummern der Untervarianten können ebenfalls eingetragen werden. Wenn das Feld frei gelassen wird, generiert das System die Nummern automatisch.

Es sieht in der Datei dann so aus.

.Eintragung der Nummern bei Hauptvariante und Varianten

image::daten/daten-importieren/assets/hvnummer.png[]

[WARNING]
.Variantennummern müssen eindeutig sein!
====
Sowohl die Nummer der Hauptvariante, als auch die Nummer der Untervarianten müssen eindeutig sein. Der Import schlägt fehl, wenn Nummern mehrfach vergeben werden.
====

=== Attribute

In unserem Beispiel haben wir *Attributauswahlkombination* im Format *Attribut:Wert;Attribut:Wert* gewählt.

.Erstellen von Varianten via Attributauswahlkombination

image::daten/daten-importieren/assets/attribute.png[]

Die oberste Zeile der Hauptvariante hat dabei keine Kombination erhalten, damit sie keine Attributverknüpfung erhählt.

[TIP]
.Hauptvariante ohne Attribute
====
Wenn man mit Variantenartikeln arbeitet und der Hauptvariante keine Attribute zuweist, ist man später flexibler in der Variantenerstellung. Gibt man der Hauptvariante ebenfalls eine Attributverknüpfung, kann man Varianten ausschließlich mit den verknüpften Attributen erzeugen.
====

=== Bilder

In unserem Sync importieren wir die Bilder-URLs in einer Zuordnung mittels Multi-URL.
Dazu muss das Feld *Multi-URL* in der Zuordnung gewählt werden. Das Format der URL wird wie folgt hinterlegt: *image1url;positionImage1,image2url;positionImage2*

=== Kategorieverknüpfungen

Mehrere Kategorien können in einer Zuordnung kommasepariert verknüpft werden. Es können Kategorienamen oder Kategorie-ID's genutzt werden. Bei den Kategorienamen muss darauf geachtet werden, dass der gesamte Kategoriepfad angegeben wird. Die Ebenen werden dabei mit einem Semikolon getrennt.

.Die Schreibweisen von Trennzeichen und Pfad sind wichtig für den Import.

image::daten/daten-importieren/assets/kategorieverknuepfungen_neu.png[]


[WARNING]
.Mapping und Datei
====
Achte darauf, dass die Werte in der Datei auch mit der Zuordnung übereinstimmen. Dabei geht es darum, dass du z.B. bei dem Feld Standardkategorie die ID oder den Namen im Mapping wählen kannst. In der CSV muss dann auch entsprechend die ID oder der Name stehen. Es geht nicht, dass im Mapping die ID, aber in der Datei der Name genutzt wird.
====

[#abgleich]
== Abgleich

Für den Abgleich ist wichtig, dass ein variantenspezifisches Abgleichfeld genutzt wird. Dafür eignet sich z.B. die Variantennummer oder auch die Varianten-ID.

Als Aktion muss „Neue Daten importieren, vorhandene aktualisieren“ eingestellt werden.


[#Zuordnungen]
== Zuordnung

In der Zuordnung verknüpfen wir die Felder aus der CSV-Datei mit den Feldern aus plentymarkets.

.Eine Zuordnung muss angelegt werden

image::daten/daten-importieren/assets/zuordnung_neu.png[]

Es empfiehlt sich, nur die Felder in die Zuordnung aufzunehmen, die tatsächlich übergeben werden sollen. Überflüssige Felder sollten deaktiviert werden, da das zu Fehlern führen kann.

Für die Artikelanlage mit Varianten gibt es Pflichtfelder, die als Minimum in der Zuordnung enthalten sein müssen, damit der Sync funktioniert. Dabei handelt es sich um folgende Felder:

* Standardkategorie
* Hauptvariantennummer
* Variantennummer
* Will man Bestand importieren, müssen folgende Werte in der Zuordnung enthalten sein:
Lager, Menge, Lagerort

Der Sync ist jetzt einsatzbereit und kann gestartet werden.

[TIP]
.Testlauf
====
Wir empfehlen, beim erstmaligen Sync vorab den Testlauf zu nutzen. So kann man prüfen, ob der Sync ordnungsgemäß läuft. Sollten sich Fehler eingeschlichen haben, kann man diese vor der kompletten Ausführung noch korrigieren.
====
