= Kaufabwicklung
:lang: de
// include::{includedir}/_header.adoc[]
:position: 30

**plentymarkets » CMS » Webdesign » Bestellvorgang » Kaufabwicklung**

== Kaufabwicklung

Die Kaufabwicklung bildet den zweiten Bereich des Bestellvorgangs. In diesen gelangt der Kunde, indem er zur Kasse geht.

[WARNING]
.Gesetzliche Anforderungen
====
Beachten Sie die seit 1.8.2012 geltenden gesetzlichen Anforderungen für den Bestellvorgang. Sie finden in den Kapiteln 2 und 3 weitere Hinweise dazu. Hier finden Sie auch Details zu den Möglichkeiten, die Sie mit plentymarkets diesbezüglich haben. Beachten Sie dazu auch unseren link:https://www.plentymarkets.eu/blog/Onlinehandel-in-Deutschland-Buttonloesung-und-neue-Informationspflichten/b-882/[**Blog-Eintrag**].
====

== Kaufabwicklung: Design bearbeiten

Dieser Bereich ist bereits vorkonfiguriert. Sie haben jedoch vielfältige Änderungsmöglichkeiten.

Folgende Bereiche können Sie im Menü **Kaufabwicklung** anpassen:

* **Kundenregistrierung** +
Hier können Sie einstellen, welche Felder ein Kunde bei der Registrierung ausfüllen muss, welche Angaben er optional machen kann und ob bestimmte Felder überhaupt angezeigt werden. Dieser Bereich der Kundenregistrierung ist z.B. für B2B-Kunden gedacht und wird mit einer Template-Funktion angezeigt.
* **Login** +
In diesen Bereich gelangt der Kunde direkt, nachdem er auf **Zur Kasse** geklickt hat. Der Kunde kann wählen, ob er als **Gast** zur Kasse geht, sich **registriert** oder, wenn er bereits registriert ist, sich anmeldet. Mit den Hinweistextfeldern können Sie ihm Hinweise zu diesen Möglichkeiten mitteilen.
* **Passwort vergessen** +
Klickt der Kunde im Bereich **Login** (Wie möchten Sie zur Kasse gehen?) auf **Passwort vergessen**, gelangt er in diesen Bereich.
* **Rechnungsanschrift** +
Hierhin gelangt der Kunde, nachdem er im Login-Bereich auf **Weiter** geklickt hat. Welche Felder ihm angezeigt werden, hängt davon ab, ob er sich registrieren möchte oder als Gast den weiteren Bestellvorgang durchläuft. Sie wählen, ob die Straße und die Hausnummer in 2 Zeilen, d.h. untereinander, oder in einer Zeile, d.h. nebeneinander, dargestellt werden. Auch die Postleitzahl und den Ort können in einer oder in zwei Zeilen dargestellt werden. Mittels CSS können Sie außerdem festlegen, wo z.B. die Felder **Straße** und **Hausnummer** dargestellt werden. Sie können z.B. für das englischsprachige Layout definieren, dass das Feld **Hausnummer** vor der Straße angezeigt wird. Tragen Sie dazu an der entsprechenden Stelle im CSS statt **float: left;** einfach **float: right;** ein. Tragen Sie auch in das Feld selbst **House number + Street** ein, damit der Kunde weiß, welches Feld für welche Informationen gedacht ist. Beachten Sie weiter unten die Hinweise zum Adresszusatz.
* **Lieferanschrift** +
Es werden die gleichen Felder wie im Bereich **Rechnungsanschrift** mit den dort hinterlegten Informationen angezeigt. Die Felder **Packstation**, **PostIdent-Nr.** und **Packstations-Nr.** werden nur angezeigt, wenn Sie Packstationen als Lieferadresse erlauben und der Kunde eine Versandart gewählt hat, bei der dies möglich ist. Beachten Sie weiter unten die Hinweise zum Adresszusatz.
* **DHL-Postfinder** +
In diesem Untermenü konfigurieren Sie die Einstellungen zum DHL-Postfinder.
* **Zahlungsart** +
Der Kunde hat bereits im Warenkorb die Möglichkeit, eine Zahlungsart zu wählen. Stellen Sie hier ein, dass ihm diese Zahlungsart nicht noch einmal angezeigt werden soll. Passen Sie dann jedoch die Nummerierung der nachfolgenden Überschriften an. Wenn Sie hier die Option **Nicht anzeigen** wählen und der Kunde ändert seine vorhergehenden Angaben so stark, dass die von ihm im Warenkorb gewählte Zahlungsart nicht mehr möglich ist, wird Ihre Einstellung überschrieben. Der Kunde gelangt dann trotzdem automatisch zu diesem Schritt der Kaufabwicklung. +
Dies gilt auch für die Optionen **Bankinformationen**, **MPay 24 Kreditkarte**, **MPay 24 Kreditkarte und MPay 24 Mobile**, da hier zusätzlich Informationen von Kunden benötigt werden.
* **Versandart** +
Der Kunde hat bereits im Warenkorb die Möglichkeit, eine Versandart zu wählen, so dass Sie hier einstellen können, dass ihm diese nicht noch einmal angezeigt werden soll. Sie sollten dann jedoch unbedingt die Nummerierung der nachfolgenden Überschriften anpassen. Wählen Sie hier die Option **Nicht anzeigen** und der Kunde ändert seine Angaben so stark, dass die im Warenkorb gewählte Versandart nicht mehr möglich ist, wird Ihre Einstellung überschrieben. Der Kunde gelangt dann trotzdem automatisch zu diesem Schritt der Kaufabwicklung.
* **Bestellübersicht** +
Der Kunde sieht hier noch einmal seine Angaben in einer Übersicht und kann durch Klicken auf **Zahlungspflichtig bestellen** seine Bestellung beenden. Der Auftrag wird in Ihrem System angelegt. Der Bereich **Bestellübersicht** enthält die Option **Position**, anhand derer Sie die Position in der Übersicht bestimmen können.

[IMPORTANT]
.Adresszusatz nicht an alle Versanddienstleister übertragbar
====
Dieses Feld ist für Zusatzangaben zur Adresse vorgesehen, z.B. Appartment 12 a. Ein Kunde kann diese Angabe auch selbst im Bestellvorgang und im Mein-Konto-Bereich hinterlegen. Manche Versanddienstleister verarbeiten dieses Feld allerdings nicht, was bedeutet, dass es nicht auf dem Etikett erscheint. Dies kann dazu führen, dass eine Sendung nicht zugestellt werden kann.

Zu folgenden Versanddienstleistern wird der Adresszusatz derzeit nicht übermittelt:

DHL Freight +
DHL Supply Chain +
Swiss Post

Um Ihre Kunden diesbezüglich zu informieren, können Sie in den genannten Bereichen z.B. einen Hinweis hinterlegen oder einblenden. Oder Sie blenden das Feld fallabhängig einfach aus, z.B. mit einem JavaScript.
====

[TIP]
.Tipp: Artikeldetails
====
Im Bereich **Artikel** stellen Sie individuelle Details zu den Artikeln ein. Dies ist im Zusammenhang mit dem nachfolgenden Hinweis zum Gesetz zum Verbraucherschutz im elektronischen Geschäftsverkehr ein wichtiger Baustein. Sie können die Artikeldetails nicht nur genau bezeichnen, sondern auch einstellen, welches Detail angezeigt werden soll und welches nicht (Bild 1 und Kapitel 3, jeweils Pos. 10).
====

[WARNING]
.Button: Zahlungspflichtig bestellen
====
Am 01.08.2012 trat eine Gesetzesänderung zur Verbesserung des Verbraucherschutzes vor Kostenfallen im Internet in Kraft. Danach muss der Text eines **Kaufen-Buttons** so formuliert sein, dass die Kostenpflicht eindeutig erkennbar ist. Der Text **Kaufen** ist demnach nicht mehr ausreichend. Der Gesetzesartikel (siehe **link:http://www.gesetze-im-internet.de/bgb/__312j.html[§ 312j BGB, Absatz 3, window="_blank"]**) empfiehlt die Formulierung **Zahlungspflichtig bestellen** oder eine Formulierung mit vergleichbar eindeutiger Aussage. Wir haben dies den Button **place_order** entsprechend angepasst. Nehmen Sie Änderungen des Textes mit Vorsicht vor und fragen Sie ggf. Ihren Rechtsberater.
====

== Beispiel: Menüeinstellungen und Ansicht im Webshop

Wir beschreiben nun die Vorgehensweise anhand des Untermenüs **Bestellübersicht**. Sie erfahren, wie Sie die Elemente dieses Bereichs verändern oder ggf. entfernen.

Die Elemente, die nachfolgend beschrieben werden, sind in Bild 1 nummeriert. In Bild 2 sehen Sie diese Elemente in der Bestellübersicht des Webshops. Anhand der Nummerierung finden Sie das Element, auf das sich die Einstellung in Bild 1 bezieht.

image::omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-01.png[]

__Bild 1: Kaufabwicklung; Optionen im Untermenü **Bestellübersicht**__

=== Einstellungen im Untermenü Bestellübersicht

Die in Bild 1 verwendeten blauen Positionsnummern finden Sie auch in Bild 2. So können Sie die Darstellung im Webshop mit den Angaben im Backend vergleichen. Lediglich die Nummern 9 und 12 finden Sie nicht in Bild 2. Nummer 9 ist nicht dargestellt, da es sich bei den Artikeln in Bild 2 nicht um Abo-Artikel handelt. Nummer 12 ist nicht dargestellt, da es sich um eine Ausfuhrlieferung und nicht um eine EU-Lieferung handelt. Nummer 12 würde anstelle von Nummer 13 abgebildet.

[cols="a,a,a"]
|====
|Pos. im Bild |Einstellung |Erläuterung

|**1**
|**Titel**
|Der hier eingetragene Titel erscheint als Bereichsüberschrift.

|**2 - 10**
|**Position**
|Mit den Positionen wird die Anordnung der Elemente in der Bestellübersicht verändert. Wenn ein Element in der Bestellübersicht nicht angezeigt werden soll, wird dies im Bereich **CSS** realisiert. Dazu wird **{display:none;}** an der entsprechenden Stelle im Code eingetragen. +
**Tipp**: Den CSS-Code prüfen, wenn Elemente nicht angezeigt werden, und für diese Elemente ggf. den Befehl **{display:none;}** aus dem Code löschen. +
**__Wichtig__**: Dem Abschnitt **Artikel** die Position 9 bzw. eine Position am Ende der Bestellübersicht in unmittelbarer Nähe zum Kaufen-Button geben. Dies wird insbesondere auch in der sogenannten Button-Lösung gefordert. +
Wurde das Design des Webshops individuell angepasst, darauf achten, die Positionen entsprechend zu vergeben.

|**10**
|**Artikel**
|Überschrift der **Artikelübersicht** in der Bestellübersicht.

|**10**
|**Artikelüberschriften**
|Überschriften der Bereiche in der **Artikelübersicht**. +
Die Überschriften werden durch Überschreiben der Einträge in den Textfeldern geändert.

|**10**
|**Artikeldetails**
|Die **Artikeldetails**, die in der Bestellübersicht angezeigt werden sollen, mit einem Häkchen markieren. +
In der Grundeinstellung sind **alle** Details markiert. +
Details zu Artikeln können auch über **<<artikel/artikel-verwalten#480, Merkmale >>** realisiert werden.

|**11**
|**Text nach Summen**
|Der eingetragene Text erscheint unmittelbar unterhalb der Gesamtsumme des Auftrags. +
Auch allgemeine Hinweise z.B. zu Zusatzkosten oder anderen Themen, wie der Button-Lösung, können eingetragen werden. Wenn ein Text eingetragen wurde, wird er unabhängig vom Lieferland immer dargestellt.

|**12**
|**Hinweis EU-Lieferungen**
|Der eingetragene Text erscheint unterhalb der Gesamtsumme des Auftrags. Wenn etwas bei **Text nach Summen** eingetragen ist, dann erscheint der Hinweis EU-Lieferungen darunter. +
Auch allgemeine Hinweise zu z.B. Zusatzkosten oder anderen Themen, wie der Button-Lösung, können eingetragen werden. Nur wenn es sich bei dem Lieferland um ein EU-Mitgliedsland handelt, wird der eingetragene Text dargestellt. Dies bei der Formulierung beachten.

|**13**
|**Hinweis Ausfuhrlieferungen**
|Der eingetragene Text wird unterhalb der Gesamtsumme des Auftrags angezeigt. Wenn etwas bei **Text nach Summen** eingetragen ist, wird der Hinweis EU-Lieferungen darunter angezeigt. +
Auch allgemeine Hinweise zu z.B. Zusatzkosten oder anderen Themen, wie der Button-Lösung, können eingetragen werden. Nur wenn es sich bei dem Lieferland nicht um ein EU-Mitgliedsland handelt, wird der eingetragene Text dargestellt. Dies bei der Formulierung beachten.

|**14**
|**Text vor Button**
|Hier z.B. einen Hinweis eintragen, der den Kunden noch einmal auffordert, seine Daten zu prüfen.

|**15**
|**Text nach**
|Der eingetragene Text wird unterhalb der Bestellübersicht angezeigt.
|====

__Tab 1: Kaufabwicklung; Optionen im Untermenü **Bestellübersicht**__

=== Ansicht der Einstellungen im Webshop

image::omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-02.png[]

__Bild 2: Kaufabwicklung; Umsetzung der Einstellungen im Untermenü **Bestellübersicht**__

== Kundenregistrierung einrichten (B2B)

Besonders für B2B-Webshops ist eine Registrierung für Händler interessant. Der Händler füllt dazu ein Formular aus. Dadurch wird ein Kundenkonto angelegt. Der Shopbetreiber ordnet dem Kundenkonto später manuell nur noch eine Kundenklasse zu, damit der Händler zu den gewünschten Rabattsätzen einkaufen kann.

Die Registrierung ist im Webshop über eine URL erreichbar, die durch die Template-Variable **$BaseURL4Links-OrderShowQQCustomerRegistration/** ausgegeben wird. Fügen Sie diese Template-Variable anstelle einer URL in einen Link ein.

[cols=""]
|====
|
[source,xml]
----
<a href="{% Link_CustomerRegistration() %}" title="Registrierung"HIER REGISTRIEREN</a>

----

|====

Das Design der Registrierungsseite können Sie im Untermenü **Kundenregistrierung** unter **CMS » Webdesign » Bestellvorgang » Kaufabwicklung** konfigurieren.

[TIP]
.Tipp: Template-Funktion nutzen
====
Alternativ können Sie auch die Template-Funktion **{% Link_CustomerRegistration() %}** in das Template einfügen und die Kundenregistrierung wird darüber aufgerufen. Sie finden diese Funktionen über das Symbol **Template-Variablen und -Funktionen** (Bild 4, grüner Pfeil) unter **Global** und dort im Ordner **PageDesignFunctions**.
====

image::omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-03.png[]

__Bild 3: Kaufabwicklung; Untermenü **Kundenregistrierung**__

Sie können in diesem Untermenü **Pflichtfelder** festlegen, die dann ausgefüllt werden müssen.

[WARNING]
.Pflichtfeld Telefonnummer
====
Die Angabe der Telefonnummer ist z.B. bei Rückfragen oder Rückmeldungen wichtig. Bei fehlender Telefonnummer kommt es bei Auslandsbestellungen bzw. Sendungen zu einer Fehlermeldung bei der Datenübergabe an DHL Intraship, da dort bei Auslandsversand die Telefonnummer eine Pflichtangabe ist.
====

== Bilder-Galerie und Template-Variablen und -Funktionen

image::omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-04.png[]

__Bild 4: Kaufabwicklung; Template-Variablen und -Funktionen__

=== Bilder-Galerie

Durch Klick auf **<<omni-channel/online-shop/_cms/bilder-galerie#, Bilder-Galerie  >>** (Bild 4, blauer Pfeil) öffnen Sie die Bilder-Galerie. Hier wählen Sie die Bilder, die Sie in dem Bereich hinterlegen möchten.

Weitere Informationen zum Einbinden von Bildern aus der Bilder-Galerie finden Sie in der Tabelle auf der Handbuchseite **<<omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/warenkorb#, Warenkorb  >>**.

=== Template-Variablen und -Funktionen

Eine Übersicht aller in diesem Bereich verwendbaren Template-Variablen und -Funktionen öffnen Sie, indem Sie auf das Symbol klicken (Bild 4, grüner Pfeil). Wenn Sie eine Template-Variable oder -Funktion in einen Hinweistext oder in das CSS einfügen, wird der Inhalt während der Kaufabwicklung angezeigt.

[IMPORTANT]
.Beispiel: Darstellung von Preisen
====
Template-Variablen wie **$ItemAmountNetDot** dienen der Darstellung von Zahlenwerten (Preisen). Der letzte Teil der Variablen, hier Dot, gibt das Trennzeichen, z.B. vor einem Centbetrag, an. Sie können somit diese Template-Variablen nutzen, um für die jeweilige Sprache die Anzeige der Preise, Versandkosten etc. anzupassen. So können Sie für das deutsche Design die Kommaseparierung und für das englische Design die Punktseparierung bei Geldbeträgen umsetzen.
====

[WARNING]
.Dot-Variablen
====
Wenn Sie diese Template-Variablen an anderer Stelle zur Übertragung von Daten verwenden möchten, müssen Sie die Dot-Variablen verwenden, da nur diese für eine Datenübertragung geeignet sind.
====

Die Template-Variablen und -Funktionen finden Sie unter **CMS » Webdesign** nach Klick auf das Icon **Template-Variablen und -Funktionen**. Im Ordner **Basket** befinden sich Unterordner der entsprechenden Bereiche der Kaufabwicklung mit den verfügbaren Funktionen und Variablen.

== Design-Beispiel

Nachfolgend finden Sie ein Design-Beispiel für die Kaufabwicklung Ihres Webshops sowie den entsprechenden CSS-Code.

=== Kaufabwicklung als Tabs

Mit dem folgenden CSS-Code werden die Schritte der Kaufabwicklung, die im Standard-Layout als Untermenüs angezeigt werden, in Tabs dargestellt (Bild 5).

image::omni-channel/online-shop/_cms/webdesign/webdesign-bearbeiten/bestellvorgang/assets/DE-CMS-Bestell-Kaufabwicklung-05.png[]

__Bild 5: Kaufabwicklung; Darstellung in Tabs__

Die Breite der Tabs ist im Standard-Layout nicht hinterlegt, sondern wird durch den folgenden CSS-Code festgelegt. Aufgrund dieser Festlegung ist nur eine bestimmte Zeichenlänge für die Titel der Tabs möglich. Passen Sie die Titeltexte ggf. entsprechend an. Die Bezeichnungen bzw. Texte der Tabs sind in den Untermenüs unter **CMS » Webdesign » Bestellvorgang » Kaufabwicklung** hinterlegt und können dort geändert werden. Passen Sie dazu die Textzeile **Titel** wie gewünscht an (siehe auch Bild 5).

[.instruction]
CSS-Code für Tab-Darstellung einfügen:

. Kopieren Sie den folgenden Code
. Öffnen Sie das Menü **CMS » Webdesign**.
. Öffnen Sie das Untermenü **Layout » CSS » CSSOrder**.
. Fügen Sie den Code anschließend an den bestehenden Code ein.
. Klicken Sie auf **Speichern**, um die Einstellungen zu sichern.

**Code für die Darstellung der Kaufabwicklung als Tabs:**

[source,plenty]
----
/* TAB CHECKOUT */

/* parent container */
#PlentyOrderCheckoutAccordion {
position: relative;
padding-top: 1px;
}
/* anchors */
#PlentyOrderCheckoutAccordion > a {
position: absolute;
top: 0;
left: 0;
}
/* tabs */
.AccordionTitle {
position: absolute;
top: 0;
white-space: nowrap;
overflow: hidden;
background: #ffffff !important;
border: 1px solid #eeeeee;
border-bottom: 2px solid #CCCCCC;
font-size: 12px;
line-height: 26px;
padding: 5px 10px;
/*text-align: center;*/
}
/* tabs hover */
.AccordionTitle:hover {
background: #f9f9f9 !important;
}
/* individual tabs */
#PlentyOrderWebLoginTitle { left: 0; width: 138px; }
#PlentyOrderWebInvoiceDetailsTitle { left: 140px; width: 158px; }
#PlentyOrderWebShippingDetailsTitle { left: 290px; width: 118px; }
#PlentyOrderWebPaymentMethodTitle { left: 420px; width: 108px; }
#PlentyOrderWebShippingMethodTitle { left: 530px; width: 98px; }
#PlentyOrderWebOrderOverviewTitle { left: 630px; width: 78px; }
/* current tab */
.CurrentAccordionTitle {
background: #cccccc !important;
border: 1px solid #CCCCCC !important;
border-bottom: 2px solid #CCCCCC !important;
}
/* tabs hover */
.CurrentAccordionTitle:hover {
background: #CCCCCC !important;
}
/* content */
#PlentyOrderCheckoutAccordion > .AccordionPane {
margin-top: 43px;
} <font face="Times"<span style="white-space: normal;"
</span></font>
----

