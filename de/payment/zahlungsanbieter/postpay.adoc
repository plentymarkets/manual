= Alter Webshop: POSTPAY
:lang: de
include::{includedir}/_header.adoc[]
:keywords: POSTPAY, Zahlungsart
:description: Payment in plentymarkets: Richten Sie die Schnittstelle zu POSTPAY in Ihrem plentymarkets System ein.
:position: 190

[IMPORTANT]
.Einrichtung der Schnittstelle nur in Callisto Shops
====
Diese Handbuchseite beschreibt ausschließlich die Einrichtung der Schnittstelle *POSTPAY* in Callisto Shops. Die folgenden Anleitungen sind somit nicht für Ceres Shops gültig!
====

link:http://www.postpay.de/de/p/postpay/postpay.html[POSTPAY^] ist der Zahlungsdienst der Deutschen Post. Mit POSTPAY bieten Sie Ihren Webshop-Kunden eine Zahlungs- und Bestellabwicklung an, die bereits von vielen Kunden der Deutschen Post genutzt wird. POSTPAY bündelt die Zahlungsarten *Lastschrift*, *Vorkasse*, *Giropay*, *SOFORT Überweisung*, *Kreditkarte* und *Kauf auf Rechnung*.

[#10]
== Wichtige Hinweise

In diesem Kapitel erhalten Sie wichtige Hinweise zur Integration des Zahlungsanbieters in plentymarkets.

[IMPORTANT]
.Auftragsanlage
====
Ein Auftrag wird in plentymarkets erst beim Zahlungseingang angelegt, erfolgt also noch nicht im Bestellvorgang bei Klick auf die Schaltfläche *POSTPAY* im Warenkorb.
====

[.subhead]
*Bezahlvorgang:*

Nach dem Bestätigen der Bestellung wird der Kunde auf eine Seite von POSTPAY weitergeleitet. Dort muss er sich in seinen POSTPAY-Account einloggen, eine Zahlungsoption wählen und die Zahlung bestätigen. Je nachdem, ob der Kunde bereits in Ihrem Webshop den Checkout-Prozess durchlaufen und dort POSTPAY als Zahlungsart gewählt hat, oder ob er auf die Schaltfläche *POSTPAY* im Warenkorb klickt, ohne sich eingeloggt zu haben, muss er unter Umständen noch seine Rechnungs- und Lieferanschrift bei POSTPAY eingeben.

Hier die beiden Varianten im Überblick:

* Der Kunde ist in Ihrem Webshop eingeloggt und hat dort bereits Rechnungs- und Lieferanschrift eingegeben. Diese Daten werden bei der Weiterleitung zu POSTPAY übernommen, können aber durch den Kunden noch angepasst werden.
* Der Kunde ist nicht in Ihrem Webshop eingeloggt und wählt *POSTPAY* über die Schaltfläche im Warenkorb. Der Kunde wird zu POSTPAY weitergeleitet und loggt sich dort mit seinen POSTPAY-Daten ein. Die primäre Zahlungsart und die Adresse sind bereits hinterlegt und die Bestellung kann mit einem Klick abgeschlossen werden. Hat der Kunde noch keinen POSTPAY-Account, muss er dort seine Daten für Rechnungs- und Lieferanschrift eingeben.

[#20]
== Bei POSTPAY registrieren

Sofern Sie bereits einen Händlerkonto bei link:https://de.allyouneed.com/de/customerlogin.html[Allyouneed.com^] haben, ist keine erneute Registrierung notwendig. Sie können sofort mit der <<payment/zahlungsanbieter/postpay#30, Einrichtung von POSTPAY>> beginnen.

Wenn Sie noch keinen Vertrag haben, registrieren Sie sich bei link:https://de.allyouneed.com/de/dealer/page/selfsignup/step1?ssu=postpay[POSTPAY^]. Im Anschluss erhalten Sie den Händlervertrag für Allyouneed.com und POSTPAY per Post oder E-Mail übermittelt, der unterschrieben zurückgesendet werden muss. Ergänzen Sie den Händlervertrag um Angaben zum wirtschaftlichen Berechtigten und zum gesetzlichen Vertreter. Nach einer internen Prüfung durch POSTPAY wird Ihr Konto aktiviert und Sie erhalten per E-Mail eine Bestätigung mit Ihren Zugangsdaten. Die Zugangsdaten benötigen Sie im nächsten Schritt für die Einrichtung in plentymarkets.

[#30]
== POSTPAY in Callisto einrichten

Gehen Sie wie unten beschrieben vor, um die Schnittstelle zu POSTPAY für Ihren Callisto Shop in plentymarkets einzurichten.

[.instruction]
Schnittstelle zu POSTPAY einrichten:

. Öffnen Sie das Menü *System » Systemeinstellungen » Aufträge » Zahlung » Zahlungsarten*.
. Aktivieren Sie die Einstellung *Auch inaktive zeigen*.
. Öffnen Sie den Ordner *DE*.
.  Klicken Sie auf *POSTPAY*. +
→ Das Tab *Einstellungen* wird geöffnet.
. Wechseln Sie in das Tab *Schnittstelle*.
.  Klappen Sie den Mandanten auf.
.  Nehmen Sie die Einstellungen vor. Beachten Sie dazu die Erläuterungen in <<tabelle-schnittstelleneinrichtung-postpay>>.
. *Speichern* Sie die Einstellungen.

[[tabelle-schnittstelleneinrichtung-postpay]]
.Schnittstelle zu POSTPAY einrichten
[cols="1,3"]
|====
|Einstellung |Erläuterung

|*Benutzername*
|Benutzername eingeben, wie von POSTPAY erhalten.

|*Passwort*
|Passwort eingeben, wie von POSTPAY erhalten.

|*Testmodus aktivieren*
|Testmodus aktivieren, um die POSTPAY-Funktionen zu testen, bevor mit dem System live gearbeitet wird.

|*Zugangsdaten für alle Mandanten (Shops) aktivieren*
|Nur sichtbar, wenn Mandanten eingerichtet sind. Aktivieren, um die Kontoeinstellungen, die über *Konto hinzufügen* für den Hauptshop gespeichert wurden, für alle Mandanten (Shops) zu übernehmen, unabhängig davon, was für andere Mandanten gespeichert wurde. Deaktivieren, um separate Zugangsdaten für weitere Mandanten (Shops) zu verwenden. Webshops, für die kein Konto hinzugefügt wurde, können mit POSTPAY nicht genutzt werden. +
Zur Unterstützung mehrerer Mandanten muss im Menü <<webshop/webshop-einrichten#grundeinstellungen, System » Systemeinstellungen » Mandant » Mandant wählen » Webshop » Einstellungen>> für die Option *Login* die Einstellung *Login in jedem einzelnen Shop ermöglichen* aktiviert sein.
|====

[#40]
== Zahlungsart aktivieren

Richten Sie die <<payment/zahlungsarten-verwalten#20, Zahlungsart>> POSTPAY im Tab *Einstellungen* der Zahlungsart ein. Prüfen Sie zudem die Einstellungen für *Erlaubte Zahlungsarten* in den <<payment/zahlungsarten-verwalten#30, Kundenklassen>> und für *Gesperrte Zahlungsarten* in den <<fulfillment/versand-vorbereiten#1000, Versandprofilen>>.

[#50]
== URL für Push-Service hinterlegen

Loggen Sie sich mit Ihren Daten bei POSTPAY ein und geben Sie im Tab *Verwaltung* die *URL für den Push-Service* ein. Mit dieser URL teilen Sie POSTPAY mit, wohin Zahlungsbestätigungen gesendet werden sollen. Die URL ist nach folgendem Muster aufgebaut:

*IHRE_DOMAIN/plenty/api/payment_notification.php?payment=postpay&amp;*

Diese URL passen Sie gemäß der Domain Ihres Shops an und speichern sie im *POSTPAY*-Backend.

[#60]
== Gutschrift für POSTPAY-Auftrag manuell anlegen

Es kann notwendig werden, für einzelne Aufträge, die über POSTPAY abgewickelt werden, Gutschriften zu erstellen. Sie haben hierfür die Möglichkeit, individuelle Gutschriftenbeträge an POSTPAY zu senden.

[.instruction]
Gutschrift an POSTPAY senden:

. Öffnen Sie das Menü *Aufträge » Aufträge bearbeiten*.
. Öffnen Sie hier den POSTPAY-Auftrag. +
→ Das Tab *Übersicht* wird geöffnet.
. Wählen Sie die Option *anlegen* aus der Dropdown-Liste *Gutschrift ...*. +
→ Die Gutschrift wird angelegt.
. Öffnen Sie die neu angelegte Gutschrift.
. Wechseln Sie in das Tab *Einstellungen*.
. Geben Sie im Feld *POSTPAY Gutschrift senden* den Betrag ein.
. Klicken Sie auf *POSTPAY Gutschrift senden*. +
→ Die Gutschrift wird an POSTPAY gesendet.

[#70]
== Versandbestätigungen automatisch senden

Richten Sie eine <<automatisierung/ereignisaktionen#, Ereignisaktion>> ein, um Versandbestätigungen automatisch zu versenden, nachdem der Warenausgang gebucht wurde.

[.collapseBox]
.Ereignisaktion einrichten
--
.  Öffnen Sie das Menü *System » Systemeinstellungen » Aufträge » Ereignisse*.
.  Klicken Sie auf *Ereignisaktion hinzufügen*. +
→ Das Fenster *Neue Ereignisaktion erstellen* wird geöffnet.
.  Geben Sie einen Namen ein.
.  Wählen Sie das *Ereignis* gemäß Tabelle 2.
. *Speichern* Sie die Einstellungen.
.  Nehmen Sie die Einstellungen gemäß Tabelle 2 vor.
.  Setzen Sie ein Häkchen bei *Aktiv*.
. *Speichern* Sie die Einstellungen.
--
.Ereignisaktion zum automatischen Senden von Versandbestätigungen an POSTPAY
[cols="1,3,3"]
|====
| Einstellung | Option | Auswahl

|*Ereignis*
|*Auftragsänderung: Warenausgang gebucht*
|

|*Filter 1*
|*Auftrag &gt; Zahlungsart*
|*POSTPAY*

|*Filter 2*
|*Auftrag &gt; Auftragstyp*
|*Auftrag*

|*Aktion*
|*Versand &gt; Versandbestätigung an POSTPAY senden*
|
|====

[#80]
== Retouren automatisch senden

Richten Sie eine <<automatisierung/ereignisaktionen#, Ereignisaktion>> ein, um Retouren automatisch an POSTPAY zu senden. Weitere Details zum Anlegen von Retouren finden Sie auf der Handbuchseite <<auftraege/auftraege-verwalten#400, Retoure>>.

[.collapseBox]
.Ereignisaktion einrichten
--
. Öffnen Sie das Menü *System » Systemeinstellungen » Aufträge » Ereignisse*.
. Klicken Sie auf *Ereignisaktion hinzufügen*. +
→ Das Fenster *Neue Ereignisaktion erstellen* wird geöffnet.
. Geben Sie einen Namen ein.
. Wählen Sie das *Ereignis* gemäß Tabelle 3.
. *Speichern* Sie die Einstellungen.
. Nehmen Sie die Einstellungen gemäß Tabelle 3 vor.
. Setzen Sie ein Häkchen bei *Aktiv*.
. *Speichern* Sie die Einstellungen.
--
.Ereignisaktion zum automatischen Senden von Retouren an POSTPAY
[cols="1,3,3"]
|====
|Einstellung |Option |Auswahl

|*Ereignis*
|*Auftragsanlage: Neue Retoure (durch Kunde)*
|

|*Filter 1*
|*Auftrag &gt; Auftragstyp*
|*Retoure*

|*Filter 2*
|*Auftrag &gt; Zahlungsart*
|*POSTPAY*

|*Aktion*
|*Retoure &gt; Retoure an POSTPAY senden*
|
|====

[#90]
== Gutschriften automatisch senden

Um Gutschriften automatisch zu senden, benötigen Sie einen <<auftraege/auftraege-verwalten#1200, Auftragsstatus>> für Gutschriften. Sie können einen Standardstatus verwenden oder einen eigenen Auftragsstatus erstellen. Nur fertig bearbeitete Gutschriften erhalten diesen Status. Diese Gutschriften dürfen nach dem Anlegen nicht geändert werden. Richten Sie eine <<automatisierung/ereignisaktionen#, Ereignisaktion>> ein, um Gutschriften automatisch an POSTPAY zu senden.

[.collapseBox]
.Ereignisaktion einrichten
--
.  Öffnen Sie das Menü *System » Systemeinstellungen » Aufträge » Ereignisse*.
.  Klicken Sie auf *Ereignisaktion hinzufügen*. +
→ Das Fenster *Neue Ereignisaktion erstellen* wird geöffnet.
.  Geben Sie einen Namen ein.
.  Wählen Sie das *Ereignis* gemäß Tabelle 4.
. *Speichern* Sie die Einstellungen.
.  Nehmen Sie die Einstellungen gemäß Tabelle 4 vor.
.  Setzen Sie ein Häkchen bei *Aktiv*.
. *Speichern* Sie die Einstellungen.
--
.Ereignisaktion zum automatischen Senden von Gutschriften an POSTPAY
[cols="1,3,3"]
|====
| Einstellung | Option | Auswahl

|*Ereignis*
|*Auftragsänderung: Statuswechsel*
| Status für die *Gutschrift an POSTPAY* wählen.

|*Filter 1*
|*Auftrag &gt; Auftragstyp*
|*Gutschrift*

|*Filter 2*
|*Auftrag &gt; Zahlungsart*
|*POSTPAY*

|*Aktion*
|*Zahlungsarten &gt; Gutschrift an POSTPAY senden*
|
|====

[#100]
== Stornierung automatisch senden

Richten Sie eine <<automatisierung/ereignisaktionen#, Ereignisaktion>> ein, um POSTPAY automatisch über Stornierungen zu informieren.

[.collapseBox]
.Ereignisaktion einrichten
--
.  Öffnen Sie das Menü *System » Systemeinstellungen » Aufträge » Ereignisse*.
.  Klicken Sie auf *Ereignisaktion hinzufügen*. +
→ Das Fenster *Neue Ereignisaktion erstellen* wird geöffnet.
.  Geben Sie einen Namen ein.
.  Wählen Sie das *Ereignis* gemäß Tabelle 5.
. *Speichern* Sie die Einstellungen.
.  Nehmen Sie die Einstellungen gemäß Tabelle 5 vor.
.  Setzen Sie ein Häkchen bei *Aktiv*.
. *Speichern* Sie die Einstellungen.
--
.Ereignisaktion zum automatischen Senden von Stornierungen an POSTPAY
[cols="1,3,3"]
|====
| Einstellung | Option | Auswahl

|*Ereignis*
|*Auftragsänderung: Statuswechsel*
| Status für *stornierte Aufträge* wählen.

|*Filter 1*
|*Auftrag &gt; Auftragstyp*
|*Auftrag*

|*Filter 2*
|*Auftrag &gt; Zahlungsart*
|*POSTPAY*

|*Aktion*
|*Zahlungsarten &gt; Stornierung an POSTPAY senden*
|
|====
