= Alter Webshop: SOFORT Überweisung
:lang: de
include::{includedir}/_header.adoc[]
:keywords: sofort überweisung, Zahlungsart, sofortüberweisung, sofortueberweisung
:description: Payment in plentymarkets: Richte die Schnittstelle zu SOFORT Überweisung in deinem plentymarkets System ein.
:position: 240
:url: payment/zahlungsanbieter/sofortueberweisung

[IMPORTANT]
.Einrichtung der Schnittstelle nur in Callisto Shops
====
Diese Handbuchseite beschreibt ausschließlich die Einrichtung der Schnittstelle *Sofortüberweisung.de* für Callisto Shops. Für die Verwendung von *Sofortüberweisung.de* in Ceres Shops erhältst du ausführliche Informationen in der Beschreibung des Plugins im link:https://marketplace.plentymarkets.com/plugins/payment/SOFORT_5050[plentyMarketplace^].
====

link:https://www.sofort.com/ger-DE/kaeufer/su/online-zahlen-mit-sofort-ueberweisung/[SOFORT Überweisung^] ist das Direkt-Überweisungsverfahren der SOFORT GmbH. Mit der Zahlungsart *SOFORT Überweisung* veranlasst der Kunde noch während der Bestellung die Überweisung in seinem Online-Banking-Konto. Du als Händler erhältst nach Abschluss der Transaktion über SOFORT Überweisung eine Echtzeitbestätigung. So kannst du Lagerware und digitale Güter sofort versenden - der Kunde erhält seine Einkäufe schneller. Direkt nach dem Zahlungseingang wird die Bestellung in plentymarkets als bezahlt markiert.

SOFORT Überweisung entspricht den hohen Sicherheitsstandards des Online-Bankings und verfügt über TÜV-geprüften Datenschutz. Deine Kunden müssen sich weder registrieren, noch benötigen sie eine Kreditkarte. Sie bezahlen einfach, sicher und schnell direkt mit ihrem Online-Bankkonto.

[#10]
== Wichtige Hinweise

Nach dem Abschluss der Bestellung wird dem Kunden ein Formular mit eine Schaltfläche angezeigt. Durch Klick auf diese Schaltfläche wird der Kunde auf eine Seite von SOFORT Überweisung weitergeleitet, um dort die weiteren benötigten Angaben zu machen. Nach Eingabe und Bestätigung oder bei Abbruch wird der Kunde zurück in den Webshop geleitet.

In der Statushistorie von Aufträgen, die mit SOFORT Überweisung bezahlt wurden, wird nach erfolgreicher Bestellung eine Echtzeitbestätigung vermerkt und die Freigabe für den Versand erteilt. Die Überweisung wurde durch den Kunden bereits ausgeführt, der Betrag ist aber nicht direkt auf deinem Konto verbucht. In der Zahlungshistorie wird die Echtzeitbestätigung ebenfalls vermerkt. Wenn du <<payment/bankdaten-verwalten#70, EBICS>> eingerichtet hast, wird der Auftrag nach erfolgreichem Zahlungsimport automatisch als bezahlt markiert. Es wird ein zweiter Eintrag in der Zahlungshistorie erstellt. Wenn du kein EBICS verwendest, musst du die <<payment/zahlungen-verwalten#40, Zahlung manuell buchen>>.

[#20]
== Bei SOFORT Überweisung registrieren

Um SOFORT Überweisung in plentymarkets einzurichten, benötigst du ein Konto bei link:https://www.sofortueberweisung.de/payment/createNew/go[SOFORT Überweisung^]. Nachdem du dich registriert hast, erhältst du die Zugangsdaten, die du für plentymarkets benötigst.

[#30]
== SOFORT Überweisung in Callisto einrichten

Beim Einrichten der Schnittstelle zu SOFORT Überweisung hast du die Möglichkeit, entweder ein bestehendes Projekt von SOFORT Überweisung mit plentymarkets zu verknüpfen oder ein neues Projekt anzulegen.

[#40]
=== Bestehendes Projekt verknüpfen

Wenn du bei SOFORT Überweisung bereits ein Projekt angelegt hast, dann richte zunächst die Schnittstelle zu SOFORT Überweisung in plentymarkets ein und nimm anschließend Einstellungen im Admin-Bereich von SOFORT Überweisung vor, damit Zahlungseingänge von SOFORT Überweisung erfolgreich an plentymarkets übergeben werden.

[.instruction]
Schnittstelle zu SOFORT Überweisung einrichten:

. Öffne das Menü *Einrichtung » Aufträge » Zahlung » Zahlungsarten*.
. Aktiviere die Einstellung *Auch inaktive zeigen*.
. Öffne den Ordner *International*.
. Klicke auf *Sofortüberweisung.de*. +
→ Das Tab *Einstellungen* wird geöffnet.
. Wechsle in das Tab *Schnittstelle*.
.  Nimm die Einstellungen vor. Beachte dazu die Erläuterungen in <<tabelle-schnittstelleneinrichtung-sofort>>.
. *Speichere* die Einstellungen.

[[tabelle-schnittstelleneinrichtung-sofort]]
.Schnittstelle zu SOFORT Überweisung einrichten
[cols="1,3"]
|====
|Einstellung |Erläuterung

|*Kunden-Nr.; +
Projekt-Nr.; +
Projekt-Passwort; +
Benachrichtigungs-Passwort*
|Daten eingeben, wie von SOFORT Überweisung erhalten.

|*Verwendungszweck*
|Verwendungszweck wählen. +
*Kundennummer* = Deine Kundennummer als Verwendungszweck für den Bezahlvorgang übermitteln. +
*Datum* = Datum des Bezahlvorgangs als Verwendungszweck für den Bezahlvorgang übermitteln. +
*Benutzerdefinierter Freitext* = In der folgenden Zeile einen Text eingeben, der als Verwendungszweck für den Bezahlvorgang übermittelt wird.
|*Benutzerdefinierter Freitext*
|Wenn unter *Verwendungszweck* die Option *Benutzerdefinierter Freitext* gewählt wurde, einen Text für die Anzeige des Verwendungszwecks eingeben.
|====

Damit Zahlungseingänge von SOFORT Überweisung erfolgreich an plentymarkets übergeben werden, müssen die folgenden Einstellungen im Admin-Bereich von SOFORT Überweisung in dem gewünschten Projekt vorgenommen werden:[#50]

* Erfolgslink für die Shopsystem-Schnittstelle eingeben: *https://-USER_VARIABLE_0-/?result=ok&amp;ak=-USER_VARIABLE_3_URLENCODE-&amp;id=-USER_VARIABLE_1_URLENCODE-*
* Abbruchlink für die Shopsystem-Schnittstelle eingeben: *https://-USER_VARIABLE_0-/?result=cancel&amp;ak=-USER_VARIABLE_3_URLENCODE-&amp;id=-USER_VARIABLE_1_URLENCODE-* +
→ Wenn Du kein SSL nutzt, nur *http* eingeben.
* Automatische Weiterleitung aktivieren
* E-Mail-Benachrichtigung anlegen: *Deine E-Mail-Adresse*
* HTTP-Benachrichtigung anlegen: *$DEINE_DOMAIN/plenty/api/payment_notification.php?payment=sofort_ueberweisung* +
→ Wenn vorhanden, SSL-Domain eingeben, damit sensible Daten über eine verschlüsselte Verbindung gesendet werden.
* Nicht mehr änderbare Eingabeparameter *Betrag* und *Verwendungszweck* aktivieren, damit diese im Zahlungsprozess von deinen Kunden nicht mehr änderbar sind.
* Parameter *Kunden-Nr* (User_id), *Projekt-Nr* (Project_id), *Projektpasswort* und *Benachrichtigungskennwort* mit den Daten in plentymarkets abgleichen. Bei der Überprüfung der Einträge der Hash-Algorithmus *SHA1* wählen.

[#60]
=== Neues Projekt über plentymarkets anlegen

Auf *Neues Projekt* klicken, um ein neues Projekt einzurichten. Neue Projekte werden in plentymarkets oder im Account bei SOFORT Überweisung angelegt - die angelegten Projekte werden in beiden Fällen bei SOFORT Überweisung gespeichert. +
Wenn Projekte *manuell* bei SOFORT Überweisung angelegt werden, müssen die Daten noch in plentymarkets eingegeben werden.

[.instruction]
Neues Projekt anlegen:

. Öffne das Menü *Einrichtung » Aufträge » Zahlung » Zahlungsarten*.
. Aktiviere die Einstellung *Auch inaktive zeigen*.
. Öffne den Ordner *International*.
. Klicke auf *Sofortüberweisung.de*. +
→ Das Tab *Einstellungen* wird geöffnet.
. Wechsle in das Tab *Schnittstelle*.
.  Klicke auf *Neues Projekt*.
.  Gib deine Daten ein. +
→ Pflichtfelder sind mit *** gekennzeichnet.
.  Gib einen Projektnamen ein.
.  Klick auf *Einrichten*. +
→ Du wirst zu SOFORT Überweisung weitergeleitet. Folge dort dem Einrichtungsassistenten.

[#70]
== Zahlungsart aktivieren

Richte die <<payment/zahlungsarten-verwalten#20, Zahlungsart>> Sofortüberweisung.de in deinem plentymarkets ein und aktiviere die Zahlungsart. Sobald diese Einstellungen vorgenommen wurden, wird dem Endkunden auch bei der Zahlungsart *Überweisung / Vorkasse* in der Verkaufsabwicklung zusätzlich eine Schaltfläche zur Zahlungsabwicklung von SOFORT Überweisung angeboten. Auf diese Weise hat der Endkunde die Wahl, entweder per Überweisung zu zahlen oder SOFORT Überweisung zu nutzen. Prüfe zudem die Einstellungen für *Erlaubte Zahlungsarten* in den <<payment/zahlungsarten-verwalten#30, Kundenklassen>> und für *Gesperrte Zahlungsarten* in den <<fulfillment/versand-vorbereiten#1000, Versandprofilen>>.

[#80]
== Testmodus aktivieren

SOFORT Überweisung bietet die Möglichkeit, testweise Transaktionen durchzuführen, um Benachrichtigungen etc. zu prüfen.

[.instruction]
Testtransaktion aus deinem Shopsystem durchführen:

. Logge dich bei SOFORT Überweisung ein.
. Öffne den Bereich *Meine Projekte*.
. Wähle ein Projekt.
. Aktiviere den *Testmodus*.
. *Speichere* die Einstellungen.
. Führe eine Bestellung mit der Zahlungsart SOFORT Überweisung in deinem Webshop durch.

[IMPORTANT]
.Richtige Bankleitzahl im Testmodus eingeben
====
Wenn du den Testmodus aktiviert hast, musst du eine der folgenden Bankleitzahlen eingeben:

Deutschland: 88888888

Belgien: 999

Sonstige: 00000

Bei der Eingabe anderer Bankleitzahlen wird die Überweisung trotz Testmodus abgeschickt. Weitere Angaben wie die Kontonummer, PIN oder TAN können frei erfunden werden.
====

Wenn du den Test durchgeführt hast, deaktiviere den Testmodus wieder.

[#90]
== Zahlungseingänge importieren

Zahlungen werden von SOFORT Überweisung so oft gesendet, bis sie erfolgreich in plentymarkets importiert sind. Zusätzlich besteht die Möglichkeit, in deinem Konto bei SOFORT Überweisung unter *Benachrichtigungen* (Fehlerhafte HTTP-Benachrichtigungen) den Status fehlerhafter Übertragungen einzusehen. Dort kannst du auch fehlerhafte Sendungen wiederholen.

[WARNING]
.Domainwechsel
====
Bei einem Domainwechsel müssen die <<payment/zahlungsanbieter/sofortueberweisung#50, Einstellungen>> bei SOFORT Überweisung im Backend angepasst werden - die URLs stimmen dann nicht mehr. Der Zahlungsablauf funktioniert weiterhin, aber die Zahlungen werden nicht mehr ins System importiert.
====
