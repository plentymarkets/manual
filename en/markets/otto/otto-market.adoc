= OTTO market
:lang: en
include::{includedir}/_header.adoc[]
:keywords: OTTO market, OTTO, marketplace, Otto assistant, Otto category group, Otto marketplace, Otto setup, setting up Otto
:description: Multi-Channel in plentymarkets: Set up the interface to OTTO market in your plentymarkets system.
:position: 20
:url: markets/otto/otto-market
:id: SMKVRT7
:author: team-multi-channel

This page provides information about OTTO market, OTTO's marketplace model.

[#100]
== OTTO market

OTTO market is OTTO's marketplace. You are shown as the seller of your products. You also manage the customer communication yourself. +

Connecting to this market allows for the following automatic processes to take place:

* Order import every 15 minutes
* Stock synchronisation every 15 minutes
* Daily update of item data


[#200]
== Setting up an account

The basic settings for OTTO market are carried out in the *Setup » Assistants » Omni-Channel* menu with the *OTTO market basic settings* assistant. With this assistant, you set up your OTTO market account in plentymarkets. You enter your API access data in this assistant, activate the data exchange with OTTO market and link shipping service providers. +

In order to open the assistant, go to *Setup » Assistants » Omni-Channel* and click on the *OTTO market Basic settings* assistant. The assistant opens and you can start setting up your account.


[#275]
== Activating the order referrer

In order to link items, properties etc. with OTTO market, you have to activate the order referrer OTTO market in the *Setup » Orders » Order referrer* menu.

[.instruction]
Activating the order referrer for OTTO market:

. Go to *Setup » Orders » Order referrer*.
. Activate the referrer *OTTO market*.
. *Save* (icon:save[role="green"]) the settings.


[#300]
== Setting the variation availability

You need to activate all variations that you want to sell on OTTO market. This is done in the *Availability* tab of a variation within the *Item » Edit item » Open item » Tab: Variation ID* menu.

[TIP]
.Selling all variations of an item on OTTO market
====
To sell all variations of an item on OTTO market, carry out the settings described below for the main variation. The settings are then passed on to all variations of the item.
====

[.instruction]
Activating the variation availability for OTTO market:

. Go to *Item » Edit item » Open item » Tab: Variation ID » Tab: Settings*.
. Open the variation that you want to sell on OTTO market.
. In the *Availability* area, activate the option *Active*.
. Click on the *Availability* tab.
. In the *Markets* area, click in the selection field. +
→ A list of all available markets is displayed.
. Activate the option *OTTO market*.
. Activate the option *Web API*.
. Click on *Add* (icon:plus-square[role="green"]). +
→ The market is added.
. *Save* (icon:save[role="green"]) the settings.

[#350]
== Setting the availability for images

The availability *OTTO market* has to be saved for an image in the *Item » Edit item » Open item » Tab: Images* menu so that item images are displayed on OTTO market.

[.instruction]
Setting the availability for images:

. Go to *Item » Edit item » Open item » Tab: Images*.
. In the *Availability* drop-down list, activate the option *OTTO market*.
. *Save* (icon:save[role="green"]) the settings. +
→ The variation image is displayed on OTTO market.


[#400]
== Defining a sales price

Proceed as described below to define a sales price for the order referrer OTTO market. The price is displayed on OTTO market.

[.instruction]
Defining a sales price for OTTO market:

. Go to *Setup » Item » Sales prices » Open sales price » Tab: Settings*.
. Activate the referrer *OTTO market*.
. *Save* (icon:save[role="green"]) the settings.


[#425]
== Activating the payment method

Activate the <<payment/managing-payment-methods#, payment method>> *Otto Payment* as described below.

[.instruction]
Activating the *Otto payment* method:

. Go to *Setup » Orders » Payment » Methods*.
. Activate the option *Also show inactive*.
. Open the folder *International*.
. Click on *Otto Payment*. +
→ The *Settings* tab opens.
. Carry out the settings. Pay attention to the explanations given in <<#payment-method-otto-market>>.
. Place a check mark next to the option *Active*.
. *Save* (icon:save[role="green"]) the settings.

[[payment-method-otto-market]]
.Settings for the payment method
[cols="1,3"]
|====
|Setting |Explanation

| *Language*
|The following options are saved for the language selected: *Name*, *Info page*, *Info page (internal)*, *Logo*, and *Upload logo*. This enables you to enter values for these options in various languages. The values for a language are activated as soon as a buyer selects the language in the online store.

| *Name*
|Enter the name that should be displayed in the online store and on invoices etc.

| *Info page*
|Select a category page of the type *content* or enter the URL of a website to provide information about the payment method.

| *Info page (external)*
|If you selected the *Info page (external)* option under *Info page*, then enter the URL of the info page here.

| *Countries of delivery*
|Do not select a country of delivery. +
You cannot use the payment method in your online store. Therefore, this payment method is only activated in plentymarkets. It is not completely set up.

| *Logo*
|Select one of the following options for displaying the logo: +
*Show standard logo* = The logo that is saved in plentymarkets for this payment method is displayed. +
*Do not show a logo* = The logo that is saved in plentymarkets for this payment method is not displayed. +
*Show upload logo* = The options *Logo view* and *Upload logo* are displayed.

| *Logo view*
|If *Show upload logo* was selected from the *Logo* drop-down list, then the logo that was uploaded is displayed here.

| *Upload logo*
|If *Show upload logo* was selected from the *Logo* drop-down list, then upload an external logo here. +
Click on *Upload files* and select the logo that you want to upload for the payment method. Permitted data formats: GIF, PNG, and JPG.

| *Priority*
|Select the priority for displaying the payment method in the online store.

| *Costs: Flat rate or percentage*
|If the payment method results in additional costs, enter the percentage value or flat rate value. The choice depends on the conditions of your contract. *Important:* Do not enter a value into both fields.  +
For further information, refer to the <<basics/working-with-plentymarkets/statistics/managing-statistics#, Managing statistics>> page. For an example of flat rate and percentage costs, refer to the <<payment/managing-payment-methods#20, Managing payment methods>> page.
|====

[TIP]
.Permitting the payment method in customer classes
====
Go to *Setup » CRM » Classes* to activate or deactivate *permitted payment methods*. +
For further information, refer to the <<payment/managing-payment-methods#30, Permitting the payment method in a customer class>> chapter.
====

For further information, refer to the <<payment/managing-payment-methods#, Managing payment methods>> page.


[#450]
== Setting up the item export

Item data is exported to OTTO market via catalogue templates. Catalogues are created with the *OTTO market Creating catalogues* assistant in the *Setup » Assistants » Omni-Channel* menu. For further information about catalogues, refer to the <<data/exporting-data/managing-catalogues#, Managing catalogues>> page. +

In catalogues, you link your item data saved in plentymarkets to OTTO market data fields. The mandatory fields for each OTTO category group are already linked in the assistant. Afterwards, open the catalogue that you created with the assistant to link further optional OTTO market data fields not marked with an asterisk with item data saved in plentymarkets. This way, you can describe your items in more detail. Your items are more likely to be sold with a detailed description. For more information about the plentymarkets data sources that can be linked, refer to the <<data/exporting-data/managing-catalogues#_mapping_data_sources, Mapping data sources>> chapter.

[.instruction]
Linking data fields in the catalogue:

. Go to *Data » Catalogues*.
. Click on the OTTO market catalogue. +
→ The catalogue opens. +
→ The market's data fields are displayed on the left-hand side. +
*Tip:* Mandatory fields are marked with an asterisk. Mandatory fields were already linked in the *OTTO market Creating catalogues* assistant.
. Select a plentymarkets data source for the market's data fields from the drop-down list.
. Click on *Add source* to assign another plentymarkets data source to a data field. +
→ A new line is displayed. +
*Note:* Only one value is exported even if you assign more than one data source to a data field. The data is checked in the order in which you assigned it. This means that if the first data field does not provide a value, the second data field is exported etc.
. Link the desired data fields.
. *Save* (icon:save[role="green"]) the settings.

An example of how to link the data field *Stock* to data saved in plentymarkets is provided below. The data field *Stock* defines the warehouse from which stock should be exported to OTTO market.

[.instruction]
Linking the data field *Stock*:

. Go to *Data » Catalogues*.
. Click on the catalogue. +
→ The catalogue opens.
. Select a plentymarkets data source for the OTTO market data field from the *Source* drop-down list. To do so, expand the plentymarkets data source *Stock*. +
→ All warehouses saved in plentymarkets are displayed in the drop-down list.
. Select the warehouse which should be used to export stock to OTTO market and click on *Select* (icon:check-square[role="green"]). +
→ *Tip:* If you would like to transfer stock from multiple warehouses to OTTO market, click on *Add source* (icon:link[role="yellow"]) and add more warehouses.
. *Save* (icon:save[role="green"]) the settings. +
→ If you do not link the data field *Stock* to a warehouse, then the sum of the net stock of all distribution warehouses (data source *Virtual warehouse*) will be exported to OTTO market.

[IMPORTANT]
====
.Link all mandatory fields
The mandatory fields for the templates are marked with an asterisk. To make sure that all necessary item data is provided, link at least the mandatory fields. For OTTO market, mandatory fields are already linked in the *OTTO market Creating catalogues* assistant.
====


[#475]
== Linking variations with OTTO category groups

After you created a catalogue template for OTTO market with the *OTTO market Creating catalogues* assistant or manually, the property *OTTO category group* is created in your plentymarkets system. A new selection value is added to the *OTTO category group* property for each OTTO category group selected in the *Name and category group* step of the assistant. In order for your variations to be exported in the appropriate catalogue, they have to be linked to the *OTTO category group* property in the *Properties* tab of a variation.

[.instruction]
Linking a variation with an OTTO category group:

. Go to *Item » Edit item »* _Open item_.
. Click on the *Variations* tab.
. Open the variation that should be linked.
. Open the *Properties* tab.
. In the *Variation properties* area, select the property *OTTO category group* from the *Properties* drop-down list and click on *Add* (icon:plus-square[role="green"]). +
→ The property is added.
. Select the desired category group from the *Value* drop-down list for the *OTTO category group* property. +
→ The variation will be exported in this catalogue. +
→ *Example:* If you select the value *Betten* (Beds), then the variation will be exported in the in the catalogue for the OTTO category group *Betten*.
. *Save* (icon:save[role="green"]) the settings.


[#500]
== Setting up event procedures

Set up <<automation/event-procedures#, event procedures>> to automatically inform OTTO market about order status changes. The following event procedures can be set up for OTTO market:

* Versandinformation an OTTO melden (Send shipping confirmation to OTTO)
* Auftragsstornierung an OTTO melden (Send order cancellation to OTTO)
* Retoure an OTTO melden (Send return to OTTO)
* Ablehnung der Retoure an OTTO melden (Send rejection of return to OTTO)

How to set up the event procedures in plentymarkets is described in the following chapters.

[IMPORTANT]
.Sequence of event procedures
====
Note that event procedures for OTTO market must be triggered in a specific sequence. First, the event procedure <<Generating DHL return labels, Generate DHL Retoure Online label>> must be triggered and afterwards the event procedure <<Sending shipping confirmations to OTTO, Send shipping confirmation to OTTO>>. If no return label was created, the shipping confirmation cannot be sent to OTTO market.
====

[#550]
=== Generating DHL return labels

When OTTO market orders are imported into your plentymarkets system, then DHL return labels must be generated for those orders before the shipping confirmation is sent to OTTO market. The procedure *Generate DHL return label* automatically creates a tracking number for a return (retTrackingNumber) which is saved for the order. This is to ensure that a tracking number exists if customers wish to return an item. +

To ensure that the tracking number is sent to OTTO market along with the order confirmation, you have to create the event procedure *Generate DHL Retoure Online label*.

*Note:* At the moment, the return label can only be generated with DHL. Further shipping service providers will be available soon.

[IMPORTANT]
.Install DHL Retoure Online plugin
====
In order to generate a DHL return label, the *DHL Retoure Online* plugin has to be installed, activated and set up in your plentymarkets system. The plugin is available in the link:https://marketplace.plentymarkets.com/en/plugins/integration/dhlretoureonline_6714[plentyMarketplace^]{nbsp}icon:external-link[].
====

How to set up the <<automation/event-procedures#, event procedure>> to create a DHL return label is described below.

:table-event-procedure: <<#dhl-return-label-otto>>

include::../../_includes/textblocks/instructions/EA.adoc[]

[[dhl-return-label-otto]]
.Event procedure to create a DHL return label
[cols="1,3,3"]
|====
|Setting |Option |Selection

| *Event*
| *New order*
|

| *Filter 1*
| *Order > Order type*
| *Order*

| *Filter 2*
| *Order > Referrer*
| *OTTO market*

| *Procedure*
| *Plugins > Generate DHL Retoure Online label*
|
|====

[#700]
=== Sending shipping confirmations to OTTO

Set up an <<automation/event-procedures#, event procedure>> to inform OTTO market that an item has been shipped.

[TIP]
.Save sender address
====
Shipping confirmations will only be sent to OTTO market if the seller's sender address was saved. You can save the address in the settings of a warehouse under *Setup » Stock » Warehouse »* _Select warehouse_ *» Settings*. You have to save the address for the warehouse that is used in the respective order.
====

:table-event-procedure: <<#shipping-confirmation-otto>>

include::../../_includes/textblocks/instructions/EA.adoc[]

[[shipping-confirmation-otto]]
.Event procedure to send a shipping confirmation to OTTO market
[cols="1,3,3"]
|====
|Setting |Option |Selection

| *Event*
| *Status change: e.g. status [7] Shipped*
|

| *Filter 1*
| *Order > Order type*
| *Order*

| *Filter 2*
| *Order > Referrer*
| *OTTO market*

| *Procedure*
| *Plugins > Versandinformation an OTTO melden* (Send shipping confirmation to OTTO)
|
|====

[#800]
=== Sending order cancellations to OTTO

Set up an <<automation/event-procedures#, event procedure>> to inform OTTO market about the cancellation of an order. It might be required to cancel orders because of different reasons. For example, if you as seller cancel an order, select *Status [8] Cancelled]*. If the customer cancels an order, select *Status [8.1]Cancelled by customer*.

:table-event-procedure: <<#order-cancellation-otto>>

include::../../_includes/textblocks/instructions/EA.adoc[]

[[order-cancellation-otto]]
.Event procedure to send an order cancellation to OTTO market
[cols="1,3,3"]
|====
|Setting |Option |Selection

| *Event*
| *Order change: Status change*
| *[8] Cancelled* or *[8.1] Cancelled by customer*

| *Filter 1*
| *Order > Order type*
| *Order*

| *Filter 2*
| *Order > Referrer*
| *OTTO market*

| *Procedure*
| *Plugins > Auftragsstornierung an OTTO melden* (Send order cancellation to OTTO)
|
|====

[#900]
=== Sending returns to OTTO

Set up an <<automation/event-procedures#, event procedure>> to inform OTTO market about a return.

:table-event-procedure: <<#return-otto>>

include::../../_includes/textblocks/instructions/EA.adoc[]

[[return-otto]]
.Event procedure to send returns to OTTO market
[cols="1,3,3"]
|====
|Setting |Option |Selection

| *Event*
| *Order generation: New return*
|

| *Filter 1*
| *Order > Order type*
| *Return*

| *Filter 2*
| *Order > Referrer*
| *OTTO market*

| *Procedure*
| *Plugins > Retoure an OTTO melden* (Send return to OTTO)
|
|====

[#1000]
=== Sending return rejections to OTTO

Set up an <<automation/event-procedures#, event procedure>> to inform OTTO market about the rejection of a return.

:table-event-procedure: <<#return-rejection-otto>>

include::../../_includes/textblocks/instructions/EA.adoc[]

[[return-rejection-otto]]
.Event procedure to send the rejection of a return to OTTO market
[cols="1,3,3"]
|====
|Setting |Option |Selection

| *Event*
|Select an event, for example *Order change: Status change* +
*Note:* Select a status that suits your workflow. For example, you can create the status *[8.2] Reject OTTO return*.
|

| *Filter 1*
| *Order > Order type*
| *Return*

| *Filter 2*
| *Order > Referrer*
| *OTTO market*

| *Procedure*
| *Plugins > Ablehnung der Retoure an OTTO melden* (Send rejection of return to OTTO)
|
|====


[#1050]
== OTTO market order management

This chapter informs you how orders are processed at OTTO market.

[#1100]
=== Order import

OTTO market orders are imported into plentymarkets with status *[3] Waiting for payment*. After an order was confirmed by OTTO market, it changes to status *[5] Shipment process started*. A payment is created for the order in plentymarkets and the order is marked as *paid*. If customers paid an OTTO market order per bank transfer, it might take longer to confirm the order than for other payment methods. In plentymarkets, the payment method is always *OTTO Payment*. +

If customers do not pay for an order, the order will be cancelled by OTTO market after some time. A cancellation will be sent to plentymarkets. In plentymarkets, the unpaid order automatically changes to status *[8] Cancelled*.

[#1200]
=== Invoice import

Invoices for OTTO market orders are generated by OTTO market and automatically imported into plentymarkets after you sent a shipping confirmation to OTTO market. Shipping confirmations are sent with the event procedure <<Sending shipping confirmations to OTTO market, Send shipping confirmation to OTTO>>. The invoice documents can be accessed in the *Receipts* tab of the main order after the shipping confirmation was sent. This means that you cannot create invoices for OTTO market in plentymarkets. +

OTTO market creates invoices as soon as an item was shipped. Therefore, invoices are also created for partial deliveries.


[#1300]
== FAQ

[qanda]

Which product title is shown at OTTO market?::
The product title which is displayed on OTTO market is composed of the following OTTO market fields that can be mapped in the catalogue: *Brand* + *Model* + *Specific characteristics* + all fields that have the information *Namenbildend*, indicated in parentheses.

Why aren't my items being exported to OTTO market?::
You can find out why some of your items are not exported to OTTO market and therefore are not available on the online market by looking at the following logs.
+
[.instruction]
. In the *Log*, enter *Otto itemexport* into the *Integration* drop-down list and select *Plenty\\Modules\\Otto\\Item\\Services\\ItemExportService*.
. In the *Level* drop-down list, enter both *warning* and *error* one after the other.
. Open the logs containing the message *Variation invalid*. +
→ In the log, you will receive the variation ID and the reason for the rejection or the missing property. +
→ This example shows variation ID 30170 and the missing productDescription.brand. This means that the manufacturer or the brand is missing.
. Next, search for the variation listed in the *log* to make sure that you will find the correct item. +
→ The manufacturer can be found in the *Global* tab of a variation.
. In the *Audio » Radios* catalogue, the brand *AudioAffairs* is not mapped. This leads to the item being rejected and causes the error message.
. Click on *Add brand* (icon:plus-square[role="green"]) to add the brand *AudioAffairs*.
+
[[filters-item-export-log]]
.Search terms for OTTO market in the log
[cols="1, 1, 1" grid=none]
|===
a|image::markets/otto/assets/otto-item-export.png[Search terms OTTO market logs]
a|image::markets/otto/assets/level-warning-error.png[Log level]
a|image::markets/otto/assets/variation-id.png[Variation ID]
|===

How can I assign a return package to the correct order in my plentymarkets system?::
An example of a DHL return label is provided below. The label contains all necessary data.
+
[[dhl-return-label]].
.DHL return label
image::markets/otto/assets/dhl-return-label.png[DHL return label]

How do I find orders in my plentymarkets system?::
As this question frequently arises in the plentymarkets forum, a short explanation is provided below.
+
The *PositionID* (example: 715e9369-01e3-4d09-ae91-8688dfa139b2) and the *SalesOrderID* (example: 4245eac7-4647-4f76-8c48-261afb19aa96) are frequently mentioned in the plentymarkets forum. However, these IDs are not relevant for you as seller. You cannot see these IDs. They serve to identify an order and the order positions in the plentymarkets database.
+
Orders with the order referrer *OTTO market* receive the usual order ID from your plentymarkets system. However, to identify the order, an external order number is saved for the order. With this number, the order can be clearly assigned.
+
Screenshots illustrating how OTTO market orders are created in plentymarkets and in the *Mein Konto* (My account) area at OTTO market are provided below.
+
[[otto-market-order-number]]
."Mein Konto” (My account) area at OTTO market
image::markets/otto/assets/otto-market_order-number.png[OTTO market order number]
+
The order number is saved as external order number at the order in plentymarkets.
+
Find a screenshot of the menu for searching the order with the external order number below:
+
[[otto-market-external-order-number]]
.Searching for the external order number
image::markets/otto/assets/otto-market_search_external-order-number.png[Search external order number]
+
The external order number can be found in the *Settings* tab of an order (*Ext. order number*):
+
If customers have further questions concerning an order, you can find an order by searching for the external order number.
+
Additionally, you can use the *Referrer* filter to filter OTTO market orders.

The log shows the error "Duplicate entry. Combination of the fields variationId, marketId and accountId must be unique". How can I solve this error?::
This error is also indicated as “SKU 1234 not generated” in the log.
+
How SKUs should be generated is defined in the catalogue. There is a distinction between the *Parent SKU* and the *Variation SKU*. The source selected here should be a data record which exists only once. Hence, it is not possible to use the same SKU for different items. For example, you could use the *Item ID* and the *Variation ID*. Both IDs are generated when the item is created in plentymarkets and only exist once. However, it might happen that the item export is carried out with errors because of missing information in the catalogue. The SKU is created anyway and can now be found in the *Availability* tab of a variation. During the next export, your plentymarkets system will try again to create an SKU from the sources selected in the catalogue. However, as this SKU already exists, the error “Duplicate entry. Combination of the fields variationId, marketId and accountId must be unique." / “SKU 1234 not generated.” occurs.
+
Therefore it is necessary to add a fallback solution in the catalogue. The solution looks like this:
+
[[add-source]]
.Add source
image::markets/otto/assets/otto-market_add_source.png[Add source]
+
[IMPORTANT]
.Add source
====
When adding another source, it is mandatory to use the *Add source* button (icon:link[role="yellow"]) on the right-hand side of the catalogue. Do _not_ use the *+ Additional source* button (icon:plus-square[role="green"]) because in this case, your SKUs would be created twice and the error could not be solved.
====
+
A second source is added. During the next export, the first source will be retrieved first. As the SKU is already included in this source, the second source will be ignored. If the first source does not contain an SKU, then a new SKU will be generated using the second source.

The log shows the errors "Code:“200009 - ATTRIBUTE_CHANGE_DENIED" or "title: Der Wert dieses Feldes kann nicht geändert werden." ("title: The value of this field cannot be changed.") How can I solve these errors?::
+
These errors indicate that you changed an OTTO item attribute. However, OTTO does not accept the change and it is not possible the change the attribute for this item. The indicated attribute can relate to a variation attribute or a title attribute. Other OTTO attributes are important here, too.
+
[TIP]
.Items cannot be deleted at OTTO market
====
An item _cannot be deleted_ at OTTO market, neither by plentymarkets nor by OTTO. It is only possible to mark the item as *not available* at OTTO market. Therefore, you should always make sure that the correct sources are mapped in the catalogue prior to transferring your items.
====
