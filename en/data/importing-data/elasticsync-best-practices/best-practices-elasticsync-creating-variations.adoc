= Best Practices: Creating variations
:lang: en
include::{includedir}/_header.adoc[]
:keywords: ElasticSync, import, items, creating items, best practice, automated
:position: 20

[TIP]
.Plugin update?
====
Before creating syncs or export formats, go to *Plugins » Plugin overview » Open plugin set* and make sure that you use the latest version of ElasticSync.
====

This page contains best practices for the plugin link:https://marketplace.plentymarkets.com/en/plugins/integration/ElasticSync_4750[ElasticSync^].

NOTE: Before you start using the best practices described on this page of the manual, you should familiarise yourself with the general functionality of ElasticSync. To do so, read the <<basics/data-exchange/ElasticSync/ElasticSync-plugin#, Importing data with ElasticSync>> page of the manual before you start on this best practice.

== Creating variations with ElasticSync

This best practice teaches you how to create items using ElasticSync.

NOTE: To benefit from this best practice, you should be familiar the basic functionality of ElasticSync. Check the <<basics/data-exchange/ElasticSync/ElasticSync-plugin#, Importing data with ElasticSync>> page of the manual for general information about how the plugin works.

[#requirements]
=== Requirements

To import items and variations using ElasticSync as described here, the following data must be saved in the system:

* Attributes
* Attribute values
* Categories
* Sales prices

[#infos]
=== Info

Go to *System » Settings » ElasticSync* to find the button *Delete cache*.

This button allows you to reset the ElasticSync cache once per hour in order to reimport a file that does not contain any changes.

Also helpful is the *Test run* button.

.Useful for testing syncs

image::basics/data-exchange/ElasticSync/assets/testrun.png[]

This imports the first 10 rows of a file without cache. This allows you to check if all values have been assigned correctly before you start syncing all rows.

Check the plugin description and the manual to find out which values are valid for these fields.

Go to *Data » Log* to access the error messages related to the sync.


[#structure_of_file]
=== Structure of the file

The following link:https://www.plentymarkets.eu/download/Testdatei.csv[sample file^] has been used for the sync.

==== General

The data that is saved *globally* at the item level, e.g. *the name, the description, etc.* is saved to the row of the main variation. During the sync, this should be saved in a separate mapping.

Data that is *variation based* must be entered into the relevant rows of the variations.

When creating the variations, it is important that the structure of the attributes and values are saved in the file matches that of the mapping.

==== Variation numbers

In this example, we will create a main variation with 4 variations. For mapping the variations, we use the main variation number.

Because the sync imports data row by row, the main variation is at the top of the file.

There, we manually save the variation number in the field of the same name. The field *Main variation number* remains empty.

This variation number is now written into the field *Main variation number* of the variations in order to map them to the main variation. Otherwise, the variations would be imported as separate main variations.

You can also enter the variation numbers of the child variations. If you leave the field empty, the system generates the numbers automatically.

The file will look like this:

.Entering the numbers for main variation and variations

image::basics/data-exchange/ElasticSync/assets/hvnumber.png[]

[WARNING]
.Variation numbers must be unique!
====
Both the number of the main variation and those of the child variations must be unique. The import fails if numbers are assigned more than once.
====

==== Attributes

In our example, we selected *attribute selection combination*:

.Creating variations using the attribute selection combination

image::basics/data-exchange/ElasticSync/assets/attributes.png[]

The first row of the main variation has not been assigned a combination so it is not linked to any attributes.

[TIP]
.Main variation without attributes
====
If you work with variation items, we recommend that you do not assign any attributes to the main variation. This provides you with more flexibility when you create variations. If you assign an attribute to the main variation, you can only create variations with the same attributes.
====

==== Images

In our sync, we will import the image URLs using 2 separate columns and mappings. You can also do this in one row by comma-separating the URLs.
For that, the field *Multi URL* must be selected in the mapping. The format of the URL is saved as follows: *image1url;positionImage1,image2url;positionImage2*

==== Category links

To link more than one category, you need to create several mappings. Also, make sure to specify the full path for the category links. The levels are separated by a semicolon.

.Correct spelling of separators and paths are essential for the import.

image::basics/data-exchange/ElasticSync/assets/categorylink.png[]


[WARNING]
.Mapping and file
====
Make sure that the values in the file match the mapping. This is because you can select different values in the mapping. For example, for the field Default category, you can select either the ID or the name. As such, the CSV file must contain either the ID or the name. You cannot use the ID in the mapping but the name in the file.
====

[#synchronisation]
=== Synchronisation

For the synchronisation, it is important that a variation-specific synchronisation field is used. A good choice is the variation number or the variation ID.

Select the option to create a new data record if no synchronisation is possible.


[#mappings]
=== Mapping

In the mapping, we map the fields in the CSV file with the fields in plentymarkets.

.Create a mapping

image::basics/data-exchange/ElasticSync/assets/set_values.png[]

We recommend that you only map those fields that you actually want to import. Unnecessary fields can result in errors and should best be avoided.

There are some mandatory fields for creating items with variations. These fields must be mapped for the sync to work. Those mandatory fields are:

* Default category
* Main variation number
* Variation number
* If you want to import stock, the following values must be part of the mapping:
Warehouse, Quantity, Storage location


[#second_mapping]
=== Second mapping

The mappings are processed one after other. That means that the second mapping runs after the first one.

Using an additional mapping, we now want to import a second category, an additional image and the global item data (e.g. name, description, etc.).

In the mapping itself, we again specify the values and map the URL and the name of the category to the second column of our file.

.Additional mappings are created in the same way as the first one.

image::basics/data-exchange/ElasticSync/assets/second_mapping_new.png[]

The sync is now ready to go and you can start it.

[TIP]
.Test run
====
We recommend that you do a test run before the first sync. This allows you to check if the sync functions as expected. If the sync does not perform as expected, you can now correct it before it is run for real.
====
