= Sending emails
:lang: en
include::{includedir}/_header.adoc[]
:keywords: login details, HTML design, info service, email template, e-mail template, email, e-mail, template variable, template variables, template functions, automatic email, event procedure, aborted purchase email
:description: Learn how to set up email templates and automatically send emails to your customers.
:position: 20
:url: crm/sending-emails

All emails that are sent with plentymarkets are based on email templates. Go to *System » System settings » Client » Select client » Email » Templates* to manage email templates. Create as many email templates as desired. In case of certain events, e.g. if a new order is placed in your online store or when a customer subscribes to a newsletter, your plentymarkets system automatically creates emails from these templates and sends them to your customers. You determine the time when the emails are to be sent automatically.

[#100]
== Saving the email server's login details

In the *System » System settings » Client » Select client » Email » Login details* menu, you save the login details of a mailbox so that plentymarkets emails such as order or shipping confirmations can be sent from this email address.

[.instruction]
Saving the email server's login details:

. Go to *System » System settings » Client » Select client » Email » Login details*.
. Carry out the settings. Pay attention to the information given in <<table-email-server-login-details>>.
. *Save* the settings.

[[table-email-server-login-details]]
.Saving the email server's login details
[cols="1,3"]
|====
|Setting |Explanation

|*Test mode*
|Select *Active* or *Inactive*. +
*Active* = The test mode is activated. All emails are only sent to the saved email address. This allows you to test the settings before switching to the live mode. +
*Inactive* = The live mode is activated. +
*_Important:_* The test mode is only applied to this online store. The settings for additional clients (stores) are carried out in the client's menu.

|*Name of sender*
|Enter your name or the name of the online store. This name is displayed to the recipient. Avoid using special characters in order to allow for correct display.

|*Email address*
|Enter the email address as it is listed in the email program.

|*Outgoing mail server/SMTP server*
|Enter the outgoing mail server as specified by the provider (usually smtp.domain.co.uk or mail.domain.co.uk). +
*_mailbox.org_*: For mailbox.org mailboxes, enter the outgoing mail server *smtp.mailbox.org* and select the encryption method *SSL*.

|*User name*
|Enter the user name that matches the email address. +
*_mailbox.org_*: The mailbox.org user name is the complete email address of the mailbox.org mailbox.

|*Password*
|Enter the password that matches the user name and email address.

|*Port (standard: 25)*
|Enter the value *25*. This value is correct for nearly all providers. Otherwise, ask your provider about the correct port. +
*_mailbox.org_*: For mailbox.org mailboxes, enter the port *465* and select the encryption method *SSL*.

|*Encryption*
|Select *SSL*, *TLS* or *No encryption*. For further information, refer to the <<crm/sending-emails#200, Selecting the encryption for email communication>> chapter. +
*_mailbox.org_*: For mailbox.org mailboxes, enter port *465* and select the encryption method *SSL*.
|====

[TIP]
.Entering newsletter login details
====
Go to *System » System settings » Client » Select client » Email » Newsletter*. Enter the login details to use the newsletter service that is integrated in plentymarkets. For further information, refer to the <<crm/sending-newsletters#200, Entering newsletter login details>> chapter of the <<crm/sending-newsletters#, Sending newsletters>> page of the manual.
====

[#200]
== Selecting the encryption for email communication

The encryption methods *SSL*, *TLS* and the setting *no encryption* are available in plentymarkets. Select one of these encryption methods for the communication with the email server. Which settings you have to carry out is described in the following sub-chapters.

[#300]
=== Security via SSL encryption

Set up SSL encryption for protected data transfer between your email programs and your mailbox. <<table-ssl-encryption>> explains the settings for SSL encryption in the *System » System settings » Client » Select client » Email » Login details* menu.

[[table-ssl-encryption]]
.Settings for SSL encryption
[cols="1,3,3,3"]
|====
|Server type |Server |Connection security |Port

|*IMAP*
|mail.YOUR-DOMAIN.co.uk
|SSL/TLS
|993

|*POP3*
|mail.YOUR-DOMAIN.co.uk
|SSL/TLS
|995

|*SMTP*
|mail.YOUR-DOMAIN.co.uk
|SSL/TLS
|587
|====

[#400]
=== Security via STARTTLS

plentymarkets also provides STARTTLS in order to ensure compatibility with older email programs. <<table-starttls-encryption>> explains the settings for STARTTLS encryption in the *System » System settings » Client » Select client » Email » Login details* menu.

[[table-starttls-encryption]]
.Settings for STARTTLS encryption
[cols="1,3,3,3"]
|====
|Server type |Server |Connection security |Port

|*IMAP*
|mail.YOUR-DOMAIN.co.uk
|STARTTLS
|143

|*POP3*
|mail.YOUR-DOMAIN.co.uk
|STARTTLS
|110

|*SMTP*
|mail.YOUR-DOMAIN.co.uk
|STARTTLS
|25
|====

[#500]
=== Unencrypted connection

[WARNING]
.Security not guaranteed
====
Unencrypted communication can be read by third parties. Unencrypted transmission does not meet current security standards.
====

<<table-unencrypted-connection>> explains the settings for unencrypted communication in the *System » System settings » Client » Select client » Email » Login details* menu.

[[table-unencrypted-connection]]
.Settings for unencrypted connections
[cols="1,3,3,3"]
|====
|Server type |Server |Connection security |Port

|*IMAP*
|mail.YOUR-DOMAIN.co.uk
|none
|143

|*POP3*
|mail.YOUR-DOMAIN.co.uk
|none
|110

|*SMTP*
|mail.YOUR-DOMAIN.co.uk
|none
|25
|====

[#600]
== Saving the email signature

Go to *System » System settings » Client » Select client » Email » Signature* to save the signature. The signature is then automatically inserted into an email template.

[IMPORTANT]
.Pay attention to the legal requirements
====
Please note the legal requirements that are in effect for your online store as to the content of an email signature, e.g. specifying the VAT number. Email signatures are required to include the same information as company business letters. Non-compliance can result in a fine or in a costly warning being issued by a competitor. If in doubt, ask a specialised solicitor.
====

[.instruction]
Saving the email signature:

. Go to *System » System settings » Client » Select client » Email » Signature*.
. Enter the text of your signature. Pay attention to the explanations given in the green box.
. *Save* the settings.

[TIP]
.Formatting the signature by means of the HTML editor
====
Select whether you save the text of your signature as *plain text signature* or *HTML signature*. If you want to format the text, it is recommended to enter the text in the *HTML signature* area. An integrated HTML editor is provided to assist you with editing and formatting.

Go to *System » System settings » Settings » Editors* and determine which editors should be available for certain areas in your plentymarkets system. Choose between *Editor*, *Syntax editor* and *Text field*.
====


[#700]
== Setting up the email information service

In the *System » System settings » Client » Select client » Email » Info service* menu, you have the possibility of sending a "blind copy" (BCC) of all emails sent by your plentymarkets system to an email address of your choice. This can be particularly helpful in the early stages of your online store, as it allows you to maintain an overview of all sent emails and recognise where processes can still be improved. You can, for example, also set that you automatically receive an informational email for each order.

[.instruction]
Setting up the email information service:

. Go to *System » System settings » Client » Select client » Email » Info service*.
. Carry out the settings. Pay attention to the information given in <<table-email-info-service>>.
. *Save* the settings.

[[table-email-info-service]]
.Setting up the email information service
[cols="1,3"]
|====
|Setting |Explanation

|*All outgoing emails are sent as blind copies (BCC) to the email address entered in the next line*
|Select whether all outgoing emails are sent as BCC to one or multiple email addresses. The email addresses are entered in the next line. +
*YES* = The option is activated. +
*NO* = The option is deactivated (default setting).

|*Email address for blind copy*
|Enter the email address(es). If you enter multiple email addresses, separate them with commas and do not use spaces.

|*Deactivate blind copies (BCC) for the newsletter*
|Select whether blind copies (BCC) should be sent for newsletters. +
Activate option = No blind copies are sent for newsletters. +
Deactivate option = Blind copies are sent for newsletters (default setting).

|*Send notification to email address when a new order was received (next line)*
|Select whether an email should be sent when an order is received. The email addresses are entered in the next line. +
*YES* = An email is sent when an order is received. +
*NO* = No email is sent (default setting). +
 *_Important:_* This function is not available for new orders on eBay. It is recommended instead to set up an <<automation/event-procedures#, event procedure>>.

|*Email address*
|Enter the email address(es). If you enter multiple email addresses, separate them with commas and do not use spaces.
|====

[#800]
== Using the HTML design

Use the *System » System settings » Client » Select client » Email » HTML design* menu to set an HTML design for each client (store). The HTML design can then be linked to email templates. You can activate or deactivate the design separately for every email template.

Use this function to ensure that for example the letterhead including the logo of your company automatically appears in all selected email templates. By doing so, it is no longer needed to insert the letterhead and the logo for each email template individually. If you make changes in this menu, you change the design for all linked email templates.

If you wish to create your email templates without a centrally saved HTML design, proceed with the <<crm/sending-emails#1200, Creating an email template>> chapter.

[#900]
=== Uploading the company logo to the image gallery

You can adapt your email templates to the design of your online store, e.g. by inserting your company logo in the HTML design. First, you have to upload the logo to the image gallery. After you created the email template, you insert the <<crm/sending-emails#1750#, logo in the HTML design>> and <<crm/sending-emails#1100, link>> the design with this email template.

[.instruction]
Uploading the company logo to the image gallery:

. Go to *CMS » Image gallery*.
. Click on the folder that you want to upload the logo to. +
→ Alternatively, create a new folder.
. Upload the logo to the folder by clicking on *Upload files* or by using the drag & drop function. +
→ The logo is uploaded.
. Click on the image. +
→ The window with the name of the image opens.
. Copy the URL from the field *Absolute URL*.
. Close the window.

For further information about the image gallery, refer to the <<omni-channel/online-store/setting-up-clients/cms#image-gallery, CMS>> page of the manual.

[#1000]
=== Inserting template variables in the HTML design

First, insert the template variables *$EmailContentHTML* and *$SignatureHTML* in the HTML design. After you created the email template, <<crm/sending-emails#1100, link>> the HTML design with the email template.

[IMPORTANT]
$EmailContentHTML must be present
====
The template variable *$EmailContentHTML* must be inserted in the HTML design. Otherwise, the HTML design cannot be used.
====

[.instruction]
Inserting template variables in the HTML design:

. Go to *System » System settings » Client » Select client » Email » HTML design*.
. First, insert the template variables *$EmailContentHTML* and *$SignatureHTML* in the HTML design. +
→ *$EmailContentHTML* contains the content of the email. *$SignatureHTML* contains the signature.
. Format the HTML design as desired.
. *Save* the settings.

Now create the email template as described in the following chapters. Afterwards, you insert the <<crm/sending-emails#1750, logo in the HTML design>> and <<crm/sending-emails#1100, link>> the design with the email template.

[#1200]
== Creating an email template

Go to *System » System settings » Client » Select client » Email » Templates* to create new email templates. The folder *General email templates* already contains preconfigured email templates. You can of course make changes to these templates.

You can define up to 2 attachments for each email template. Use email templates to automatically send your customers a PDF document that was generated in the *Orders » Fulfilment* menu, such as an invoice, as well as a document uploaded in the *CMS » Documents* menu, such as a brochure or instructions. For example, it would be useful to attach PDF documents of your cancellation rights and terms and conditions to the email template *Confirmation of online store order*.

[TIP]
.Sending reversal document and invoice in one email template
====
It is possible to select the option *Reversal document and new invoice* from the *PDF attachment* drop-down list of an email template. If the order changes after the invoice has been created, you can send your customers both documents in one email.
====

[.instruction]
Creating an email template:

. Go to *System » System settings » Client » Select client » Email » Templates*.
. Click on *New email template*. +
→ The *New email template* window opens.
. Enter the name for the template.
. Select the owner or the option *ALL* from the drop-down list *Owner*.
. *Save* the settings. +
→ The email template is created and saved in one of the 3 folders, depending on the selected setting in the *Owner* drop-down list.
. Carry out the remaining settings. Pay attention to the information given in <<table-email-template>>.
. *Save* the settings.

[[table-email-template]]
.Settings in the *System » System settings » Client » Select client » Email » Templates* menu¤
[cols="1,3"]
|====
|Setting |Explanation

|*Save*
|Saves the settings in the email template.

|*Template variables and template functions*
|Opens the *Template variables and functions* area from which the template variables and template functions are copied for the email template.

2+|Tab: Settings

|*Owner*
|If the name of the owner has already been selected from the drop-down list upon creation of the email template, the name of the owner is displayed here. Otherwise, select the owner from the drop-down list. This setting can be changed at any time. +
*All* = The template is saved under *General email templates*. +
Own user name = The template is saved under *My email templates*. +
Different user name = The template is saved under *Email templates from other users*. +
*_Note_*: You have to be logged into the system as a user in order to create your own email templates under *My email templates*.

|*Name*
|If the name has already been entered upon creation of the email template, the name of the email template is displayed here. Otherwise, enter the name for the template.
The name can be changed at any time. The name is not displayed to the recipient.

|*Content*
|Select whether the content of the email template should be saved as *plain text* or in *HTML format*. +
*_Tip_*: Use text in HTML format. The link for order processing (template function *Link_Checkout()*) can be very long. Pure text emails can lead to line breaks that can damage the link. +
*_Important:_* If you add further languages in HTML format, pay attention that the setting *Only in HTML format* is selected in the drop-down list *Content* in the *Settings* tab. The selection *Plain text only* is the standard setting for all languages.

|*Template type*
|Select for which area the email template should be available. Possible options: *All* (default setting), *Order*, *Customers*, *Online store*, *Ticket* or *Scheduler*. +
*All* / *Online store* = The email template is available for all areas. +
*Order* = The email template is only available for the selected area. It is not visible in the other areas. If the ticket is linked to an order, email templates with the template type *Order* can also be selected in the ticket. +
*Customer* = The email template is only available for the selected area. It is not visible in the other areas. +
*Ticket* = The email template is only available for the selected area. It is not visible in the other areas. +
*Scheduler* = The email template is available for all areas where the template type *Order* is visible.

|*PDF attachment*
|Select the attachment from the drop-down list. The documents that can be selected from this drop-down list are for example generated in the *Orders » Fulfilment* menu or through shipment-related processes.

|*Document attachment*
|Documents that were uploaded under *CMS » Documents* are displayed here. You can attach one of these documents to an email template. +
All email templates can be sent to customers with up to 2 attachments in a standardised way. Use email templates to send your customers PDF documents relating to fulfilment (e.g. invoices) or other files (e.g. brochures or instructions). For example, it would be useful to attach PDF documents of your cancellation rights and terms and conditions to the email template *Confirmation of online store order*.

|*Reply to*
|Enter an email address. If someone replies to the email template, their message is sent to this address. If no email address was entered, replies to the template are sent to the email address that is saved under <<crm/sending-emails#100, System » Client » System settings » Select client » Email » Login details>>. For example, it is useful to enter the accounting department's email address for the *PDF invoice* email template. Questions about the invoice would then directly be sent to your accounting department and wouldn't have to be forwarded to them in an extra step.

|*Use design*
|Activate if the content of the email should be sent with the design that was saved under *System » System settings » Client » Select client » Email » HTML design*. If the option is not activated, only the content of the email is used.

|*Client (store)*
|Activate one, multiple or *ALL* clients (stores). The email template is only valid for the selected clients (stores).

2+|Tab: Email message

|*Select a language*
|If required, select another language from the drop-down list. +
*_Note:_* The language that is set in the contact data record determines which language is sent in the email template.

|*Subject*
|Enter the subject text. Choose the subject carefully so that the emails are recognised by the email account and displayed in the customer's inbox instead of his or her spam folder.

|*Content / Item list*
|Insert the text or list of items in these tabs. Use *plain text* or text in *HTML format*. Template variables and template functions can be used to display the content. +
*_Note_*: Check which type of content was selected in the *Settings* tab under *Content*. Enter the text of the email into this corresponding tab. For example, if *Plain text only* is selected but you entered content into the *Text in HTML format* tab, this content is not sent in the email.
|====

[TIP]
.Tip: Use text in HTML format
====
plentymarkets recommends that you use text which was formatted with HTML since the link for processing orders can be very long. Pure text emails can lead to line breaks that might damage the link. Furthermore, if you use HTML-formatted text, you have the possibility to format the text by means of the integrated HTML editor.

Go to *System » System settings » Settings » Editors* and determine which editors should be available for certain areas in your plentymarkets system. Select the *editor*, *syntax editor* or *text field*.
====


[#1300]
=== Using template variables and template functions

Template variables and template functions can be used in email templates. In place of the variable or the function, your plentymarkets system automatically displays the content that this variable or function represents. In this way, only the content is displayed in the email. If you use the <<crm/using-the-ticket-system#4800, ticket system>>, some template variables can also be used as assignment parameters.

Open an email template in the *System » System settings » Client » Select client » Email » Templates* menu to display a list of all template variables and template functions that are available for your email templates.

For an overview of the template variables and template functions for email templates, refer to the <<crm/sending-emails#4000, Template variables and template functions available for email templates>> chapter.

[TIP]
.Inserting the link to the checkout in the email template
====
If possible, every email that is sent to a customer should include a link to the checkout. The customer can use this link to look at the current status of his or her order any time. Insert the template function *Link_Checkout()* in the email template.
====

[#1400]
=== Configuring the display of stock units

You can individually set up how the stock unit lines are structured for each email template and language. <<crm/sending-emails#1500, If queries>> can also be used for the configuration of stock units. If you do not set up how the stock units should be displayed, plentymarkets displays a standard list of the stock units.

[IMPORTANT]
.Add template variable $OrderProperties in the item list
====
The template variable *$OrderProperties* that displays the order properties is not contained in the standard list of the stock units in the email templates of the templates type *Order*. This means that order properties are not displayed in the stock units. If you would like that the order properties are contained in the item list, you must manually add the template variable *$OrderProperties*.
====

[.instruction]
Configuring the display of stock units:

. Go to *System » System settings » Client » Select client » Email » Templates*.
. Open the template.
. Click on the *Email message* tab. +
→ The *Content* tab is displayed.
. Insert the template variable *$ItemListHTML* in the tab *Text in HTML format* or the template variable *$ItemListPlain* in the tab *Plain text* in the email's *Content* tab. Position the template variable where you would like the stock units to be displayed.
. Copy the template variable from the overview that you need for the stock units and add the template variable to the tab *Item list*. +
​→ To help with the formatting, for example, you can insert tabs that you copied from a text program between the template variables.
. *Save* the settings.

[.subhead]
Example: Displaying stock units

Insert the template variables to display the item ID (*$ItemID*), the item name (*$ItemName*) and the item price (*$ItemPrice*) of the stock units. The display begins with a hyphen. This is used at the start of each new line, even if multiple stock units are shown. In order for the display to "work" on multiple lines, insert a line break at the end of the line by pressing Enter.

How you open the preview in order to check the email template is described in the <<crm/sending-emails#1600, Checking the email template using the preview function>> chapter.

[#1500]
=== Using if queries in email templates

Use if queries in email templates to display specific information on a case-by-case basis. For example, you can save a code that causes bank details to only be displayed in the email to the customer if cash in advance (ID = 0) was selected as the payment method. This if query can be found in the following example.

[source,plenty]
----
include::assets/Email-Templates-MethodOfPayment.html[]

----

For further information, refer to the <<omni-channel/online-store/setting-up-clients/cms-syntax#basics-if, if queries>> page of the manual.

[#1600]
=== Checking the email template using the preview function

Use the email preview function to check whether your email template meets your requirements. In particular, you should check to make sure that the link for order processing works correctly. Proceed as follows to open the preview of the email template.

[.instruction]
Checking the email template using the preview function:

. Go to *Orders » Edit orders*.
. Open the order.
. Click on the *Email* tab.
. Select the language from the *Select a language* drop-down list in the *Email templates* tab.
. Click on the tab where your email template is saved: *General email templates*, *My email templates* or *Email templates from other users*.
. Activate the email template.
. Click on *Preview*. +
→ The *Email preview* window opens.

[#1700]
=== Editing the email template

You can edit general email templates, your own email templates and email templates of other users. Go to *System » System settings » Client » Select client » Email » Templates* to edit email templates.

[.instruction]
Editing the email template:

. Go to *System » System settings » Client » Select client » Email » Templates*.
. Click on the folder where the email template that you want to edit is saved.
. Click on the email template. +
→ The *Settings* tab of the email template opens.
. Carry out the settings. Pay attention to the information given in <<table-email-template>> in the <<crm/sending-emails#1200, Creating an email template>> chapter.
. *Save* the settings.

[TIP]
.Check email template after every change
====
You should use an order's email service to check every change that is made to a template. In particular, you should check to make sure that the link for order processing works correctly. To do so, proceed as described in the <<crm/sending-emails#1600, Checking the email template using the preview function>> chapter.
====

[#1750]
== Inserting the company logo in the HTML design

In the next step, you insert the logo via an image link in the HTML design of an already created email template. Proceed as described below.

[.instruction]
Inserting the company logo in the HTML design:

. Go to *System » System settings » Client » Select client » Email » Templates*.
. Open the email template which you want to insert the logo in.
. Click on the *Email message* tab.
. Click on the *Text in HTML format* tab within the *Content* tab.
. Select the option *Editor* from the drop-down list in the top right. +
→ 2 toolbars to format the text are displayed.
. Click on *Image* in the toolbar. +
→ The *Image properties* window opens.
. Paste the absolute URL that you have just copied from the image gallery in the field *URL*.
. Click on *OK*. +
→ The logo is displayed.
. *Save* the settings.


[#1100]
== Linking the HTML design with an email template

Go to *System » System settings » Client » Select client » Email » Templates*. Carry out the following settings to link the HTML design with an email template. Make sure that the content of the email template is saved in the *Text in HTML format* tab. Save the content there if it was not saved already. This content is displayed with the template variable *$EmailContentHTML*.

[.instruction]
Linking the HTML design with the email template:

. Go to *System » System settings » Client » Select client » Email » Templates*.
. Select the email template from the folder.
. Select the option *Only text in HTML format* from the *Content* drop-down list.
. Activate the option *Use design*.
. Enter a subject in the *Email message* tab.
. *Save* the settings.

[#1800]
== Sending emails

In order to send emails, user data has to be saved in the <<basics/admin-tasks/manage-users#10, System » System settings » Settings » User » Accounts>> menu. This data can be received from your provider and corresponds to the data that is saved in your email program.

[#1900]
=== Sending ticket messages and comments as emails

An email account must be saved in the <<crm/using-the-ticket-system#2100, System » System settings » CRM » Ticket system » Email accounts>> menu in order for messages and comments to be sent as emails. You also have to set up an email template that displays the last ticket message or comment. This email template has to be linked to an <<crm/using-the-ticket-system#2900, event procedure>> in order for messages and comments to be sent via email. For further information, refer to the <<crm/using-the-ticket-system#2100, Using the ticket system>> page of the manual.

[#2000]
=== Sending coupons via email

You can send coupons and coupon codes via email. Simply attach them to emails as PDF files. For further information, refer to the chapters <<orders/coupons#100, Inserting coupon codes directly into emails>> and <<orders/coupons#140, Configuring coupon templates>> on the <<orders/coupons#, Coupons>> page of the manual.

[#2300]
== Setting up automatic emails

The *System » System settings » Client » Select client » Email » Automatic* menu contains various events that can be linked with an email template. Select the email template that you have previously <<crm/sending-emails#1200, created>> in the *System » System settings » Client » Select client » Email » Templates* menu from the drop-down list. This ensures that the email template is sent to your customer once the event occurs.

[IMPORTANT]
.Removing the link before deleting the email template
====
Deleting an email template that is linked with an event in the *Automatic email* section may lead to undesired effects. Therefore, first go to *System » System settings » Client » Select client » Email » Automatic* and remove the link by selecting the option *Do not send* from the drop-down list in the line of the event. Afterwards, you delete the email template in the *System » System settings » Client » Select client » Email » Templates* menu.
====

[.instruction]
Setting up automatic emails:

. Go to *System » System settings » Client » Select client » Email » Automatic*.
. Select an email template from the drop-down menu in the line of the event. Pay attention to the information given in <<table-events-automatic-emails>>.
. *Save* the settings.

Click on *Edit email template*. This opens the email template in the *System » Client » Select client » Email » Templates* menu. The email template can be <<crm/sending-emails#1700, edited>> here.

<<table-events-automatic-emails>> lists explanations of some of the events.

[[table-events-automatic-emails]]
.Explanations for some events in the *System » System settings » Client » Select client » Email » Automatic* menu
[cols="1,3"]
|====
|Setting |Explanation

|*New order from online store*
|The customers receive an email including the order confirmation after the purchase has been completed in the online store.

|*Send customer email to change password*
|The customers receive an email with a link to the new password. The link must be actively confirmed. The template function *{% Link_ChangePassword() %}* must be included in the email template.

|*Newsletter opt-in*
|The customers receive an email when they have registered for the newsletter. The email template should include the confirmation link that the customers have to click in order to complete the newsletter registration process.

|*Newsletter opt-in confirmation*
|The customers receive a confirmation email once they have activated the confirmation link that was sent with the email template for the *Newsletter opt-in* event.

|*Reminder in case of aborted purchase*
|The customers receive a reminder email that one or multiple items are in the shopping cart, but the purchase has not been completed yet. It also makes sense for the email template to include a link to the shopping cart. Customers can then click on this link to complete their purchase. Simply insert your online store's URL with the suffix */basket/* (example: *https://myshop.co.uk/basket/*). +
The only requirement is that potential buyers were registered and logged into your online store. Otherwise the email address is not available and the email template cannot be sent automatically. +
*_Important_*: Due to missing previous consent of the recipient, this kind of emailing can be considered to be unsolicited message (spam). Therefore, it is recommended to ask a specialised solicitor.

|*Tell-A-Friend*
|This event sends an email with the link to an item from the online store as a recommendation to an email address that the customers have entered in the Tell-A-Friend form in the online store. +
*_Important_*: Due to missing previous consent of the recipient, this kind of emailing can be considered to be unsolicited message (spam). Therefore, it is recommended to ask a specialised solicitor.

|*Registration for sweepstakes*
|The customers that have registered for the sweepstake receive a confirmation email.

|*Email when item becomes available*
|The customers receive an email containing the information that a certain item is available again. Beforehand, the customers have entered their email address directly next to the item that could not be delivered at that time.
|====

[#2350.subhead]
Setting up an automatic email taking a new order on eBay as an example

An order is automatically created in plentymarkets after a customer has purchased an item on eBay. If you have <<crm/sending-emails#1200, created>> the email template "Order confirmation eBay" for example and selected this template from the drop-down list for the event *New order from eBay* in the *System » System settings » Client » Select client » Email » Automatic* menu, an email is automatically sent to the customer. The following green box contains an example text for the email template.

[TIP]
.Example email template that should be sent after a purchase is made on eBay
====
Dear $CustomerFullName,

Congratulations on winning the auction!

In order to keep the checkout process as simple as possible, click on the following link or copy and paste it into the address line of your browser.

In the checkout area, you are able to view and make changes to your personal data as well as view our bank information. When making a bank transfer, always specify the designated use that is saved in this area.

Link_Checkout()
====

Along with the automatic email, the customer can also be sent a message via the eBay messaging system. Go to *System » System settings » Markets » eBay » Settings » Tab: Account settings » Tab: Message after purchase* and save the text. For further information, refer to the <<markets/ebay/ebay-setup#1500, Sending messages after purchase>> chapter on the <<markets/ebay/ebay-setup#, Setting up eBay>> page of the manual.

[#2310.subhead]
Setting up an event procedure

It is also possible to set up event procedures in the *System » System settings » Orders » Events* menu. Define an event, activate one or more filters and decide which procedures your plentymarkets system should carry out automatically when the event occurs. For example, you can use filters to trigger a procedure once a customer has placed a certain number of orders. The procedure could be sending an email that includes a gift card. For further information, refer to the <<automation/event-procedures#, event procedures>> page of the manual.

[#2500]
== Displaying sent email templates for each customer

Go to *Orders » Edit orders » Tab: Email » Tab: Emails sent*. There you can display all email templates that you have ever sent to the customer. Please note that only those email templates that are linked to a unique customer ID are displayed in this tab.

[.instruction]
Displaying sent email templates for each customer:

. Go to *Orders » Edit orders*.
. Open the order.
. Click on the *Email* tab.
. Click on the *Emails sent* tab. +
→ The date, time, email address of the recipient, ID and name of the template as well as the order ID are displayed.

Expand the area *Other emails sent to this customer...* to display all emails that have been sent to the customer. Here you can also see those emails that were sent to the customer from another order. Click on the order ID on the right-hand side. The order overview of the order opens in a separate tab.

[#2600]
== Displaying all sent email templates

Go to *Start » Statistics* to create a new statistic. Select the statistic type *Sent email templates* in the *Orders* section. This statistic shows information about the emails sent with your plentymarkets system according to the ID and the name of the email template. This statistical feedback is made for each date within the selected time span. The standard setting of the time span is the last 30 days. You can also adapt the time span or select a start date and an end date.

In this statistic, you can see for example which email template was used during the selected time period. This helps you to easily recognise which processes were carried out on a regular basis. For further information, refer to the <<basics/statistics#40, Statistics>> page of the manual.


[#4000]
== Template variables and template functions available for email templates


[#4100]
=== Template functions

The link functions listed in <<table-template-functions-emails>> are available for email templates.

[TIP]
.Correct "translation" of template functions
====
In order to ensure that the template functions are correctly displayed as a URL, the template function must be enclosed by *{%* and *%}*.
====

[[table-template-functions-emails]]
.Template functions available for email templates
[cols="1,3"]
|====
|Function |Explanation

|*Link_Checkout()*
|This function displays the URL for the *My account* area of the online store. +
*_Note:_* Insert *{%Link_Checkout()%}* in the email template to ensure that the URL is correctly displayed.

|*Link_TermsConditions()*
|This function displays the URL for the terms and conditions. +
*_Note:_* Insert *{%Link_TermsConditions()%}* in the email template to ensure that the URL is correctly displayed.

|*Link_Webstore()*
|This function displays the URL for the online store. +
*_Note:_* Insert *{%Link_WebStore()%}* in the email template to ensure that the URL is correctly displayed.

|*Link_NewPassword()*
|This function displays the URL for a form that allows to create a new password. The customer enters their email address in this form. +
*_Note:_* Insert *{%Link_NewPassword()%}* in the email template to ensure that the URL is correctly displayed.

|*Link_ChangePassword()*
|This function displays the URL for *Change password* area. The customer can enter a new password. +
*_Note:_* Insert *{%Link_ChangePassword()%}* in the email template to ensure that the URL is correctly displayed.

|====

[#4200]
=== Template variables

Template variables are pre-defined variables that can be inserted in email templates. When sending the emails, this variable is automatically filled with the corresponding content. Template variables start with a dollar sign ($) followed by an upper-case character. <<table-template-variables-emails>> lists the template variables that are available for email templates.


[TIP]
.Template variable logic
====
Please note that template variables can only be filled with content when certain requirements are met.

Examples:

* *$TicketLastMessage* is only filled with content when an event procedure was set up that reacts to a new ticket message
* *$orderId* is only filled and sent in combination with orders. For example, if the "Forgot password" function is used, the system would not know which order ID to use since the reference to an order is missing.
====

[[table-template-variables-emails]]
.Template variables available for email templates
[cols="1,3"]
|====
|Variable |Explanation

|$OrderID
|ID of the order

|$OrderStatusLabel
|Status text of the order

|$OrderStatusID
|Status ID of the order

|$OrderEarliestDeliveryDate
|Earliest delivery date of the order

|$OrderEstimatedShipmentDate
|Estimated shipping date of the order

|$OrderReturnDate
|Date when the return was received

|$CustomerID
|ID of the contact

|$CustomerEmail
|Email address of the contact

|$CustomerFullName
|First name (Name2) and last name (Name3) of the contact

|$CustomerState
|Region/district/county/state or any other country-specific classifications in the contact address

|$CustomerAdditionalAddress
|Additional address information saved in the contact address

|$CustomerSign
|Customer sign

|$EmailFrom
|Sender of the email

// |$ItemURLTellAFriend
// |

|$EmailMessage
|Content of the email

|$EmailSubject
|Subject of the email

|$CustomerFirstName
|The contact's first name

|$CustomerLastName
|The contact's last name

|$CustomerSalutationKey
|Possible values: 0 = male and 1 = female. Depends on the form of address saved in the contact data record.

|$CustomerSalutationLabel
|Possible values: Mr. and Ms. Depends on the form of address saved in the contact data record.

|$CustomerCompany
|Stated company of the contact

|$CustomerStreet
|Street of the contact

|$CustomerCityWithZip
|Town and postcode of the contact

|$CustomerCity
|Town of the contact

|$CustomerZip
|Postcode of the contact

|$CustomerCountry
|Country of the contact

|$CustomerCountryID
|County ID of the contact

|$CustomerCountryIsoCode
|Country ISO code of the contact

|$CustomerPhone
|Telephone number of the contact

|$CustomerMobilePhone
|Mobile phone number of the contact

|$CustomerFax
|Fax number of the contact

|$CustomerEbayName
|eBay name of the contact

|$IsNewsletterActive
|Flag that indicates whether the contact has confirmed the newsletter receipt.

|$NewsletterConfirmURL
|URL for confirming the newsletter receipt

|$CustomerLang
|Language of the contact

|$CustomerClass
|Customer class

|$CustomerNumber
|Customer number

|$CustomerTitle
|Title of the contact

|$OrderCount
|Order quantity

|$ExternalOrderID
|External order ID

|$Currency
|Currency

|$ReturnReasonID
|ID of the return reason. +
Go to *System » System settings » Orders » Order types » Return* to create reasons for returns.

|$ReturnReasonLabel
|Text of the return reason. +
Go to *System » System settings » Orders » Order types » Return* to create reasons for returns.

|$VoucherCodes
|All codes of all coupons for one order, separated by comma.

|$CustomerIBAN
|IBAN of the contact

|$CustomerBIC
|BIC of the contact

|$CustomerAccountOwner
|Name of the account owner

|$CustomerBankName
|Name of the contact's bank

|$GeneralTermsConditionsText
|Terms and conditions in plain text. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Terms and conditions » Tab: Text* to save the text.

|$GeneralTermsConditionsHTML
|Terms and conditions in HTML format. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Terms and conditions » Tab: HTML* to save the text.

|$CancellationRightsText
|Cancellation rights in plain text. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Cancellation rights » Tab: Text* to save the text.

|$CancellationRightsHTML
|Cancellation rights in HTML format. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Cancellation rights » Tab: HTML* to save the text.

|$PrivacyPolicyText
|Privacy policy in plain text. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Privacy policy » Tab: Text* to save the text.

|$PrivacyPolicyHTML
|Privacy policy in HTML format. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Privacy policy » Tab: HTML* to save the text.

|$LegalDisclosureText
|Legal disclosure in plain text. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Legal disclosure » Tab: Text* to save the text.

|$LegalDisclosureHTML
|Legal disclosure in HTML format. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Legal disclosure » Tab: HTML* to save the text.

|$WithdrawalFormText
|Cancellation form in plain text. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Cancellation form » Tab: Text* to save the text.

|$WithdrawalFormHTML
|Cancellation form in HTML format. +
Go to *System » System settings » Client » Select client » Online store » Legal information » Expand language » Tab: Cancellation form » Tab: HTML* to save the text.

|$DeliveryAddressFullName
|First and last name saved in the delivery address

|$DeliveryAddressAdditionalAddress
|Additional address information saved in the delivery address

|$DeliveryAddressFirstName
|First name saved in the delivery address

|$DeliveryAddressLastName
|Last name saved in the delivery address

|$DeliveryAddressCompany
|Company saved in the delivery address

|$DeliveryAddressPhone
|Telephone number saved in the delivery address

|$DeliveryAddressPostident
|Telephone number saved in the delivery address

|$DeliveryAddressStreet
|Street saved in the delivery address

|$DeliveryAddressCityWithZip
|Town and postcode saved in the delivery address

|$DeliveryAddressCity
|Town saved in the delivery address

|$DeliveryAddressZip
|Postcode saved in the delivery address

|$DeliveryAddressCountry
|Country saved in the delivery address

|$DeliveryAddressCountryID
|Country ID saved in the delivery address

|$DeliveryAddressCountryIsoCode
|Country ISO code saved in the delivery address

|$DeliveryAddressState
|Region/district/county/state saved in the delivery address

|$OrderEstimatedDeliveryDate
|Estimated delivery date of the order

|$OrderBillingAddressTaxId
|VAT ID in the invoice address of the order

|$OrderDeliveryAddressTaxId
|VAT ID in the delivery address of the order

|$ShippingCosts
|Shipping costs

|$ValueOfItems
|Value of the items

|$CouponValue
|Value of the coupon

|$InvoiceTotal
|Total invoice amount (gross price), separated by comma

|$InvoiceTotalDecimalSeparatorDot
|Total invoice amount (gross price), separated by a full stop

|$InvoiceTotalNet
|Total invoice amount (net price), separated by comma

|$TotalVAT
|Total amount of the value added tax in the order

|$OrderTotalNet
|Total amount of the order (net price)

|$OrderDate
|Order date

|$PaymentDate
|Date of incoming payment

|$TodaysDate
|Current date

|$PackageCount
|Package numbers. Are saved in the order.

|$TrackingURL
|The tracking URL is used to track shipments. +
The URL is saved in the *System » System settings » Orders » Shipping » Settings » Tab: Shipping service provider* menu.

|$BankAccount
|Account number. This data is saved in the *System » System settings » Settings » Bank* menu.

|$BankCode
|Sort code. This data is saved in the *System » System settings » Settings » Bank* menu.

|$BankOwner
|First name and last name of the account owner. This data is saved in the *System » Settings » Bank* menu.

|$BankName
|Name of the bank. This data is saved in the *System » System settings » Settings » Bank* menu.

|$BankIBAN
|International bank account number. This data is saved in the *System » System settings » Settings » Bank* menu.

|$BankSwift
|Bank Identifier Code. This data is saved in the *System » System settings » Settings » Bank* menu.

|$ShippingServiceProviderName
|Name of the shipping service provider

|$ShippingServiceProviderID
|ID of the shipping service provider

|$MethodOfPaymentName
|Name of the payment method as saved in the *System » System settings » Orders » Payment » Payment methods* menu.

|$MethodOfPaymentID
|ID of the payment method. +
The IDs are automatically assigned by the system and cannot be changed. The IDs are listed in the *System » System settings » Orders » Payment » Payment methods* menu.

|$ShippingProfileID
|ID of the shipping profile

|$ShippingProfileName
|Name of the shipping profile

|$ReferrerID
|ID of the referrer

|$ReferrerName
|Name of the referrer

|$PaidAmount
|Amount paid

|$OpenAmount
|Outstanding amount

|$OverpaidAmount
|Amount of the overpayment

|$PartialPaymentAmount
|Amount of the partial payment

|$PartialPaymentOpenAmount
|Outstanding amount of the partial payment

|$WarehouseID
|ID of the warehouse. +
The ID is automatically assigned by the system and cannot be changed. The ID is saved in the *System » System settings » Stock » Warehouse » Open warehouse » Settings* menu.

|$WebstoreID
|ID of the client. +
The ID is automatically assigned by the system and cannot be changed. The ID is saved in the *System » System settings » Client » Select client » Settings* menu.

|$EbaySellerAccount
|

|$EbayUniquePaymentID
|

|$SignatureText
|Signature in plain text. +
The text is saved in the *System » System settings » Client » Select client » Email » Signature* menu.

|$SignatureHTML
|Signature in HTML format. +
The text is saved in the *System » System settings » Client » Select client » Email » Signature* menu.

|$RebateAmount
|Discount amount

|$BarcodeOrderID
|Barcodeof the order ID

|$ItemCategoryLevel1List
|ID of the category where the item is saved

|$CustomerSpecialWishes
|Customer wish. During the checkout via the online store, the customer can enter a wish regarding the items they ordered. This wish is saved as order note in the order data.

|$CouponCode1
|Coupon code 1

|$CouponCode2
|Coupon code 2

|$CouponCode3
|Coupon code 3

|$CouponCode4
|Coupon code 4

|$CouponCode5
|Coupon code 5

|$CouponCode6
|Coupon code 6

|$CouponCode7
|Coupon code 7

|$CouponCode8
|Coupon code 8

|$CouponCode9
|Coupon code 9

|$CouponCode10
|Coupon code 10

|$OrderType
|Order type

|$OrderAccessKey
|By clicking on *Checkout* in the order overview, the order opens in the My account area of the online store.

|$TrustedShopsRating
|Feedback result of all feedbacks given at Trusted Shops

|$TrustedShopsRatingShopButton
|

|$TrustedShopsRatingEmailButton
|

|$TrustedShopsSeal
|Trusted Shops seal of quality

|$SchedulerID
|ID of the scheduled order

|$SchedulerStartDate
|Start date of the scheduled order

|$SchedulerEndDate
|End date of the scheduled order

|$SchedulerExecutionCount
|Number of orders that are contained in the scheduled order

|$SchedulerInterval
|Interval of the scheduled order

|$SchedulerTotalAmount
|Total amount of the scheduled orders

|$TicketHistory
|Displays the text that was last saved in the ticket, i.e. the text of a comment or a message.

|$TicketLastComment
|The last comment in the ticket

|$TicketLastMessage
|The last message in the ticket

|$TicketURL
|Links to the ticket in the *My account* area of the contact.

|$TicketBackendURL
|Links to the ticket in the *CRM » Ticket system* menu.

|$TicketTitle
|Subject of the title

|$TicketID
|ID of the ticket

|$TicketTags
|Displays the tags that are linked to the ticket. +
First, tags must be created in the *System » System settings » Settings » Tags* menu for the *Ticket* area.

|$TicketStatus
|Status of the ticket

|$TicketPriority
|Priority of the ticket

|$ReorderID
|ID of the reorder

|$ReorderDeliveryDate
|Delivery date of the reorder

|$EventType
|Type of the event

|$EventInfo
|Information about the event

|$EventDuration
|Duration of the event

|$EventBilled
|Flag that indicates that the event was billed

|$EventNotBilled
|Flag that indicates that the event was not billed

//|$EventBilledRequiringPayment
//|

//|$EventNotBilledRequiringPayment
//|

|$EventBillable
|Flag that indicates that the event can be billed

//|$EventStaffer
//|

|$ForumSubscription
|Registration in the forum

2+|$ItemListPlain / $ItemListHTML

|$ItemId
|ID of the item

|$OrderProperties
|Order properties

|$ReturnItemStatusID
|

|$ReturnItemStatusLabel
|

|$ItemNumber
|Number of the item

|$ItemName
|Item name

|$ItemQuantity
|Number of items

|$ItemPrice
|Item price

|$ItemPriceNet
|Net price of the item

|$ItemReferrer
|Referrer of the item

|$ExternalItemID
|External item ID

|$ExternalVariationID
|External variation ID

|$TransactionID
|Transaction ID

|$UnitString
|Unit of the item

|$VariationName
|Variation name

|$VariationNumber
|Variation number

|$VariationId
|ID of the variation

|$VariantName
|Variation name

|$ItemModel
|Model name of the item

|$ItemEAN
|International Article Number (EAN) of the item

|$ItemISBN
|ISBN code of the item

|$ItemASIN
|Amazon Standard Ident Number (ASIN) of the item

|$ItemAvailabilityLabel
|Text of the item availability

|$ItemAvailabilityID
|ID of the item availability

|$Free
|Free text field for the items. The texts are saved in the *System » System settings » Items » Free text fields* menu. In order that the field names are displayed, write the field number in square brackets behind. +
*_Example:_* *$Free[3]* displays the text that is saved under *Field 3*.

|$DownloadLink
|Download link for additional product details. Can be integrated in the My account area of the online store. +
*_Note:_* The files are uploaded in the *Media* tab of the item. +
*_Important_:* Files uploaded to the *Media* tab cannot be used in the Ceres online store.

|$ItemImageURL
|URL for the item image

|$ItemProducerName
|Name of the manufacturer

|$ItemVatRate
|Value added tax rate for the individual order items in percent (without indicating the percentage sign)

|$ItemWarehouseID
|Warehouse ID of the item

|$SchedulerItemStartDate
|Start date

|$SchedulerItemEndDate
|

|$ReturnItemComment
|

|$ReturnItemValuePercentage
|

|$ReturnItemReasonID
|

|$ReturnItemReasonLabel
|

|$ItemVoucherCodes
|Code of a coupon for each order item, separated by comma

|====
